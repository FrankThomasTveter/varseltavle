{"ast":null,"code":"//console.log(\"Loading DefaultLib.js\");\nfunction Default() {\n  this.deffile = \"defaults.json\"; // defaults file, contains default setup...\n\n  this.other = undefined;\n  this.trash = undefined;\n\n  this.init = function (state) {\n    var par = \"Default\";\n    state.Utils.init(par, this);\n  };\n\n  this.loadDefault = function (state, callbacks) {\n    //console.log(\"loadDefault\");\n    if (state.Threshold.thrs !== undefined) {\n      // defaults already loaded, execute callback...\n      var callback = callbacks.shift();\n\n      if (callback !== undefined) {\n        setTimeout(callback(state, callbacks), 0.1);\n      }\n    } else {\n      if (state.Database.ready) {\n        // make sure we do not re-load if we are already loading...\n        state.Database.ready = false;\n        state.Html.setFootnote(state, \"Server-request: \" + this.deffile);\n        state.Html.setProgress(state, true);\n        var defHttp = new XMLHttpRequest();\n        defHttp.addEventListener(\"progress\", state.Html.progressInfo);\n        defHttp.addEventListener(\"load\", state.Html.loadInfo);\n        defHttp.addEventListener(\"error\", state.Html.errorInfo);\n        defHttp.addEventListener(\"abort\", state.Html.abortInfo);\n\n        defHttp.onreadystatechange = function () {\n          state.Database.ready = true;\n\n          if (defHttp.readyState === 4) {\n            if (defHttp.status === 200) {\n              console.log(defHttp.responseText);\n              var e = state.Default.isEmpty;\n              var json = JSON.parse(defHttp.responseText);\n\n              if (e(state, state.Default.other) && !e(state, json.other)) {\n                state.Default.other = json.other;\n              }\n\n              if (e(state, state.Default.trash) && !e(state, json.trash)) {\n                state.Default.trash = json.trash;\n              }\n\n              state.Default.Threshold = {\n                thrs: json.thrs\n              };\n              state.Default.Colors = {\n                colors: json.colors\n              };\n              state.Default.Path = {\n                order: json.order,\n                select: json.select,\n                home: json.home,\n                tooltip: json.tooltip\n              };\n              state.Default.Layout = {\n                priority: json.priority,\n                state: json.state\n              };\n              state.Default.pushDefault(state);\n              var callback = callbacks.shift();\n\n              if (callback !== undefined) {\n                setTimeout(callback(state, callbacks), 0.1);\n              }\n            } else if (state.React !== undefined && state.React.Html !== undefined) {\n              state.React.Html.setFootnote(state, \"Unable to load \" + this.deffile);\n              state.Html.setProgress(state, false);\n            }\n          }\n        };\n\n        defHttp.responseType = \"\";\n        defHttp.overrideMimeType(\"text/text\");\n        defHttp.open(\"GET\", \"def/\" + this.deffile, true);\n        defHttp.setRequestHeader('cache-control', 'no-cache, must-revalidate, post-check=0, pre-check=0');\n        defHttp.setRequestHeader('cache-control', 'max-age=0');\n        defHttp.setRequestHeader('expires', '0');\n        defHttp.setRequestHeader('expires', 'Tue, 01 Jan 1980 1:00:00 GMT');\n        defHttp.setRequestHeader('pragma', 'no-cache');\n        defHttp.send();\n      } else {\n        state.Html.setFootnote(state, \"Already waiting for reply...\");\n        state.Html.setProgress(state, false);\n      }\n\n      ;\n    }\n\n    ;\n  };\n\n  this.pushDefault = function (state) {\n    var e = state.Default.isEmpty;\n\n    if (e(state, state.Threshold.thrs) && !e(state, state.Default.Threshold.thrs)) {\n      state.Threshold.thrs = state.Default.Threshold.thrs;\n    }\n\n    if (e(state, state.Colors.colors) && !e(state, state.Default.Colors.colors)) {\n      state.Colors.colors = state.Default.Colors.colors;\n    }\n\n    if (e(state, state.Path.order) && !e(state, state.Default.Path.order)) {\n      state.Path.order = state.Default.Path.order;\n    }\n\n    if (e(state, state.Path.home) && !e(state, state.Default.Path.home)) {\n      state.Path.home = state.Default.Path.home;\n    }\n\n    if (e(state, state.Path.tooltip.keys) && !e(state, state.Default.Path.tooltip)) {\n      state.Path.tooltip = state.Default.Path.tooltip;\n    }\n\n    if (e(state, state.Path.select) && !e(state, state.Default.Path.select)) {\n      state.Path.select = state.Default.Path.select;\n    }\n\n    if (e(state, state.Layout.priority) && !e(state, state.Default.Layout.priority)) {\n      state.Layout.priority = state.Default.Layout.priority;\n    }\n\n    if (e(state, state.Layout.state) && !e(state, state.Default.Layout.state)) {\n      state.Layout.state = state.Default.Layout.state;\n    } // console.log(\"Default thrs:\",JSON.stringify(state.Threshold.thrs));\n    // console.log(\"Default colors:\",JSON.stringify(Colors));\n    //console.log(\"Default other:\",JSON.stringify(state.Default.other));\n    //console.log(\"Default trash:\",JSON.stringify(state.Default.trash));\n    //console.log(\"Default order:\",JSON.stringify(state.Default.Path.order));\n    //console.log(\"Default path:\",JSON.stringify(state.Default.Path.home));\n\n\n    console.log(\"Default tooltip:\", JSON.stringify(state.Default.Path.tooltip)); //console.log(\"Default Layout:\",JSON.stringify(state.Default.Layout.state));\n    //console.log(\"Done loading:\",JSON.stringify(state.Default.trash));\n\n    console.log(\"Resulting tooltip:\", JSON.stringify(state.Path.tooltip));\n  };\n\n  this.hasChanged = function (state, main, item) {\n    if (state.Default !== undefined && state.Default[main] !== undefined && state.Default[main][item] !== undefined) {\n      var src = JSON.stringify(state[main][item]);\n      var trg = JSON.stringify(state.Default[main][item]); //console.log(\"Checking:\",main,item,\"\\n\",src,\"\\n\",trg);\n\n      return src !== trg;\n    } else {\n      return true;\n    }\n  };\n\n  this.isEmpty = function (state, obj) {\n    // check if obj has any string/number children\n    var ret = true;\n    var k;\n\n    if (obj === undefined) {\n      ret = true;\n    } else {\n      var typ = typeof obj;\n\n      if (typ === \"Array\") {\n        // check array children\n        for (k in obj) {\n          if (!state.Default.isEmpty(state, obj[k])) {\n            ret = false; //console.log(\"    =\",typ,ret,k,JSON.stringify(obj[k]));\n\n            break;\n          }\n        }\n      } else if (typ === \"object\") {\n        // check hash children\n        for (k in obj) {\n          if (obj.hasOwnProperty(k)) {\n            if (!state.Default.isEmpty(state, obj[k])) {\n              ret = false; //console.log(\"    =\",typ,ret,k,JSON.stringify(obj[k]));\n\n              break;\n            }\n          }\n        }\n      } else {\n        ret = false;\n      }\n    } //console.log(\"Type:\",ret,JSON.stringify(obj));\n\n\n    return ret;\n  };\n}\n\n;\nexport default Default;","map":{"version":3,"sources":["/home/franktt/react/varseltavle/src/lib/DefaultLib.js"],"names":["Default","deffile","other","undefined","trash","init","state","par","Utils","loadDefault","callbacks","Threshold","thrs","callback","shift","setTimeout","Database","ready","Html","setFootnote","setProgress","defHttp","XMLHttpRequest","addEventListener","progressInfo","loadInfo","errorInfo","abortInfo","onreadystatechange","readyState","status","console","log","responseText","e","isEmpty","json","JSON","parse","Colors","colors","Path","order","select","home","tooltip","Layout","priority","pushDefault","React","responseType","overrideMimeType","open","setRequestHeader","send","keys","stringify","hasChanged","main","item","src","trg","obj","ret","k","typ","hasOwnProperty"],"mappings":"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","sourcesContent":["//console.log(\"Loading DefaultLib.js\");\nfunction Default() {\n    this.deffile=\"defaults.json\"; // defaults file, contains default setup...\n    this.other=undefined;\n    this.trash=undefined;\n    this.init=function(state){\n\tvar par=\"Default\";\n\tstate.Utils.init(par,this);\n    };\n    this.loadDefault=function(state, callbacks ) {\n\t//console.log(\"loadDefault\");\n\tif (state.Threshold.thrs !== undefined) { // defaults already loaded, execute callback...\n\t    var callback=callbacks.shift();\n\t    if (callback !== undefined) {\n\t\tsetTimeout(callback(state,callbacks),0.1);\n\t    }\n\t} else {\n\t    if (state.Database.ready) { // make sure we do not re-load if we are already loading...\n\t\tstate.Database.ready=false;\n\t\tstate.Html.setFootnote(state, \"Server-request: \"+this.deffile);\n\t\tstate.Html.setProgress(state, true);\n\t\tvar defHttp = new XMLHttpRequest();\n\t\tdefHttp.addEventListener(\"progress\",state.Html.progressInfo);\n\t\tdefHttp.addEventListener(\"load\",state.Html.loadInfo);\n\t\tdefHttp.addEventListener(\"error\",state.Html.errorInfo);\n\t\tdefHttp.addEventListener(\"abort\",state.Html.abortInfo);\n\t\tdefHttp.onreadystatechange = function() {\n\t\t    state.Database.ready=true;\n\t\t    if (defHttp.readyState  === 4) {\n\t\t\tif (defHttp.status  === 200) {\n\t\t\t    console.log(defHttp.responseText);\n\t\t\t    var e=state.Default.isEmpty;\n\t\t\t    var json = JSON.parse(defHttp.responseText);\n\t\t\t    if (e(state,state.Default.other)&&!e(state,json.other)) {state.Default.other=json.other;}\n\t\t\t    if (e(state,state.Default.trash)&&!e(state,json.trash)) {state.Default.trash=json.trash;}\n\t\t\t    state.Default.Threshold={thrs:json.thrs};\n\t\t\t    state.Default.Colors={colors:json.colors};\n\t\t\t    state.Default.Path={order:json.order,select:json.select,home:json.home,tooltip:json.tooltip};\n\t\t\t    state.Default.Layout={priority:json.priority,state:json.state};\n\t\t\t    state.Default.pushDefault(state)\n\t\t\t    var callback=callbacks.shift();\n\t\t\t    if (callback !== undefined) {\n\t\t\t\tsetTimeout(callback(state,callbacks),0.1);\n\t\t\t    }\n\t\t\t} else if (state.React !== undefined && state.React.Html !== undefined) {\n\t\t\t    state.React.Html.setFootnote(state,\"Unable to load \"+this.deffile);\n\t\t\t    state.Html.setProgress(state, false);\n\t\t\t}\n\t\t    }\n\t\t}\n\t\tdefHttp.responseType=\"\";\n\t\tdefHttp.overrideMimeType(\"text/text\");\n\t\tdefHttp.open(\"GET\", \"def/\"+this.deffile, true);\n\t\tdefHttp.setRequestHeader('cache-control', 'no-cache, must-revalidate, post-check=0, pre-check=0');\n\t\tdefHttp.setRequestHeader('cache-control', 'max-age=0');\n\t\tdefHttp.setRequestHeader('expires', '0');\n\t\tdefHttp.setRequestHeader('expires', 'Tue, 01 Jan 1980 1:00:00 GMT');\n\t\tdefHttp.setRequestHeader('pragma', 'no-cache');\n\t\tdefHttp.send(); \n\t    } else {\n\t\tstate.Html.setFootnote(state,\"Already waiting for reply...\");\n\t\tstate.Html.setProgress(state, false);\n\t    };\n\t};\n    };\n    this.pushDefault=function(state) {\n\tvar e=state.Default.isEmpty;\n\tif (e(state,state.Threshold.thrs)&&!e(state,state.Default.Threshold.thrs)) {state.Threshold.thrs=state.Default.Threshold.thrs;}\n\tif (e(state,state.Colors.colors)&&!e(state,state.Default.Colors.colors)) {state.Colors.colors=state.Default.Colors.colors;}\n\tif (e(state,state.Path.order)&&!e(state,state.Default.Path.order)) {state.Path.order=state.Default.Path.order;}\n\tif (e(state,state.Path.home)&&!e(state,state.Default.Path.home)) {state.Path.home=state.Default.Path.home;}\n\tif (e(state,state.Path.tooltip.keys)&&!e(state,state.Default.Path.tooltip)) {state.Path.tooltip=state.Default.Path.tooltip;}\n\tif (e(state,state.Path.select)&&!e(state,state.Default.Path.select)) {state.Path.select=state.Default.Path.select;}\n\tif (e(state,state.Layout.priority)&&!e(state,state.Default.Layout.priority)) {state.Layout.priority=state.Default.Layout.priority;}\n\tif (e(state,state.Layout.state)&&!e(state,state.Default.Layout.state)) {state.Layout.state=state.Default.Layout.state;}\n\t// console.log(\"Default thrs:\",JSON.stringify(state.Threshold.thrs));\n\t// console.log(\"Default colors:\",JSON.stringify(Colors));\n\t//console.log(\"Default other:\",JSON.stringify(state.Default.other));\n\t//console.log(\"Default trash:\",JSON.stringify(state.Default.trash));\n\t//console.log(\"Default order:\",JSON.stringify(state.Default.Path.order));\n\t//console.log(\"Default path:\",JSON.stringify(state.Default.Path.home));\n\tconsole.log(\"Default tooltip:\",JSON.stringify(state.Default.Path.tooltip));\n\t//console.log(\"Default Layout:\",JSON.stringify(state.Default.Layout.state));\n\t//console.log(\"Done loading:\",JSON.stringify(state.Default.trash));\n\tconsole.log(\"Resulting tooltip:\",JSON.stringify(state.Path.tooltip));\n    };\n    this.hasChanged=function(state,main,item) {\n\tif (state.Default!==undefined && \n\t    state.Default[main]!==undefined &&\n\t    state.Default[main][item]!==undefined) {\n\t    var src=JSON.stringify(state[main][item]);\n\t    var trg=JSON.stringify(state.Default[main][item]);\n\t    //console.log(\"Checking:\",main,item,\"\\n\",src,\"\\n\",trg);\n\t    return src!==trg;\n\t} else {\n\t    return true;\n\t}\n    };\n    this.isEmpty=function(state,obj) { // check if obj has any string/number children\n\tvar ret=true;\n\tvar k;\n\tif (obj===undefined) {\n\t    ret=true;\n\t} else {\n\t    var typ=typeof obj;\n\t    if (typ === \"Array\") { // check array children\n\t\tfor (k in obj) {\n\t\t    if (! state.Default.isEmpty(state,obj[k])) {\n\t\t\tret=false;\n\t\t\t//console.log(\"    =\",typ,ret,k,JSON.stringify(obj[k]));\n\t\t\tbreak;\n\t\t    }\n\t\t}\n\t    } else if (typ === \"object\") { // check hash children\n\t\tfor (k in obj) {\n\t\t    if (obj.hasOwnProperty(k)) {\n\t\t\tif (! state.Default.isEmpty(state,obj[k])) { \n\t\t\t    ret=false;\n\t\t\t    //console.log(\"    =\",typ,ret,k,JSON.stringify(obj[k]));\n\t\t\t    break;\n\t\t\t}\n\t\t    }\n\t\t}\n\t    } else {\n\t\tret=false;\n\t    }\n\t}\n\t//console.log(\"Type:\",ret,JSON.stringify(obj));\n\treturn ret;\n    };\n};\nexport default Default;\n"]},"metadata":{},"sourceType":"module"}