{"ast":null,"code":"//console.log(\"Loading DefaultLib.js\");\nfunction Default() {\n  this.dir = \"def/\"; // defaults directory\n\n  this.setup = \"defaults.json\"; // defaults file, contains default setup...\n\n  this.path = \"test.json\";\n  this.other = undefined;\n  this.trash = undefined;\n  this.start = undefined; // setup at start\n\n  this.JsonMapFill = {\n    \"other\": [\"other\"],\n    \"trash\": [\"trash\"]\n  }; // keep Default/Url if it already exists, otherwise get from setup-file\n\n  this.JsonMapForce = {\n    \"Threshold\": {\n      \"thrs\": [\"thrs\"]\n    },\n    \"Colors\": {\n      \"colors\": [\"colors\"]\n    },\n    \"Path\": {\n      \"order\": [\"order\"],\n      \"select\": [\"select\"],\n      \"home\": [\"home\"],\n      \"tooltip\": [\"tooltip\"]\n    },\n    \"Layout\": {\n      \"priority\": [\"priority\"],\n      \"state\": [\"state\"]\n    }\n  }; // overwrite Default/Url with setup-file no-matter-what\n\n  this.DefaultMapFill = {\n    \"Threshold\": {\n      \"thrs\": [\"Threshold\", \"thrs\"]\n    },\n    \"Colors\": {\n      \"colors\": [\"Colors\", \"colors\"]\n    },\n    \"Path\": {\n      \"order\": [\"Path\", \"order\"],\n      \"home\": [\"Path\", \"home\"],\n      \"tooltip\": {\n        \"keys\": [\"Path\", \"tooltip\", \"keys\"],\n        \"select\": [\"Path\", \"tooltip\", \"select\"],\n        \"sort\": [\"Path\", \"tooltip\", \"sort\"],\n        \"click\": [\"Path\", \"tooltip\", \"click\"]\n      },\n      \"select\": [\"Path\", \"select\"]\n    },\n    \"Layout\": {\n      \"priority\": [\"Layout\", \"priority\"],\n      \"state\": [\"Layout\", \"state\"]\n    }\n  }; // overwrite state with default/url/setup, no-matter-what\n\n  this.init = function (state) {\n    var par = \"setup\";\n    state.Utils.init(par, this);\n  };\n\n  this.loadDefault = function (state, callbacks) {\n    var file = this.setup;\n    console.log(\"Default setup:\", file);\n\n    if (state.Threshold.thrs !== undefined) {\n      // defaults already loaded, execute callback...\n      state.File.next(state, \"\", callbacks);\n    } else {\n      var path = state.Default.dir + state.Default.setup;\n      state.File.load(state, path, callbacks);\n    }\n  };\n\n  this.processDefault = function (state, response, callbacks) {\n    if (state.Threshold.thrs !== undefined) {\n      // defaults already loaded, execute callback...\n      state.File.next(state, \"\", callbacks);\n    } else {\n      //console.log(\"Response:\",response);\n      try {\n        var json = JSON.parse(response);\n      } catch (e) {\n        alert(\"Default '\" + state.Default.setup + \"' contains Invalid JSON:\" + e.name + \":\" + e.message);\n      }\n\n      if (json !== undefined) {\n        //console.log(\"state:\",JSON.stringify(state.Path));\n        state.Utils.mapFill(state, state.Default.JsonMapFill, state.Default, json);\n        state.Utils.mapForce(state, state.Default.JsonMapForce, state.Default, json);\n        state.Utils.mapFill(state, state.Default.DefaultMapFill, state, state.Default); //console.log(\"JSON:\",JSON.stringify(json.tooltip));\n        //console.log(\"Default:\",JSON.stringify(state.Default.Path.tooltip));\n        //console.log(\"State:\",JSON.stringify(state.Path.tooltip));\n      }\n\n      ;\n\n      if (state.Default.start === undefined) {\n        state.Default.start = {};\n        state.Utils.mapFill(state, state.Default.DefaultMapFill, state.Default.start, state); //state.Default.save(state);\n      } // finally execute next callback\n\n\n      state.File.next(state, \"\", callbacks);\n    }\n  };\n\n  this.getSetup = function (state) {\n    var setup = state.Utils.cp(state.Default.start); // get updated information\n\n    state.Utils.mapFill(state, state.Default.DefaultMapFill, setup, state); //JSON.stringify(setup, null, \"   \");\n\n    return setup;\n  };\n\n  this.save = function (state) {\n    var setup = state.Utils.prettyJson(state.Default.getSetup(state));\n    state.Utils.save(setup, \"setup.json\", \"json\");\n  };\n\n  this.hasChanged = function (state, main, item) {\n    if (state.Default !== undefined && state.Default[main] !== undefined && state.Default[main][item] !== undefined) {\n      var src = JSON.stringify(state[main][item]);\n      var trg = JSON.stringify(state.Default[main][item]); //console.log(\"Checking:\",main,item,\"\\n\",src,\"\\n\",trg,\"->\",src!==trg);\n\n      return src !== trg;\n    } else {\n      return true;\n    }\n  };\n}\n\n;\nexport default Default;","map":{"version":3,"sources":["/home/franktt/react/varseltavle/src/lib/DefaultLib.js"],"names":["Default","dir","setup","path","other","undefined","trash","start","JsonMapFill","JsonMapForce","DefaultMapFill","init","state","par","Utils","loadDefault","callbacks","file","console","log","Threshold","thrs","File","next","load","processDefault","response","json","JSON","parse","e","alert","name","message","mapFill","mapForce","getSetup","cp","save","prettyJson","hasChanged","main","item","src","stringify","trg"],"mappings":"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","sourcesContent":["//console.log(\"Loading DefaultLib.js\");\nfunction Default() {\n    this.dir=\"def/\"; // defaults directory\n    this.setup=\"defaults.json\"; // defaults file, contains default setup...\n    this.path=\"test.json\";\n    this.other=undefined;\n    this.trash=undefined;\n    this.start=undefined; // setup at start\n    this.JsonMapFill={\"other\":[\"other\"],\n\t\t      \"trash\":[\"trash\"]\n\t\t     }; // keep Default/Url if it already exists, otherwise get from setup-file\n    this.JsonMapForce={\"Threshold\":{\"thrs\":[\"thrs\"]},\n\t\t       \"Colors\":{\"colors\":[\"colors\"]},\n\t\t       \"Path\":{\"order\":[\"order\"],\n\t\t\t       \"select\":[\"select\"],\n\t\t\t       \"home\":[\"home\"],\n\t\t\t       \"tooltip\":[\"tooltip\"]},\n\t\t       \"Layout\":{\"priority\":[\"priority\"],\n\t\t\t\t \"state\":[\"state\"]}\n\t\t      }; // overwrite Default/Url with setup-file no-matter-what\n    this.DefaultMapFill={\"Threshold\":{\"thrs\":[\"Threshold\",\"thrs\"]},\n\t\t\t \"Colors\":{\"colors\":[\"Colors\",\"colors\"]},\n\t\t\t \"Path\":{\"order\":[\"Path\",\"order\"],\n\t\t\t\t \"home\":[\"Path\",\"home\"],\n\t\t\t\t \"tooltip\":{\"keys\":[\"Path\",\"tooltip\",\"keys\"],\n\t\t\t\t\t    \"select\":[\"Path\",\"tooltip\",\"select\"],\n\t\t\t\t\t    \"sort\":[\"Path\",\"tooltip\",\"sort\"],\n\t\t\t\t\t    \"click\":[\"Path\",\"tooltip\",\"click\"]},\n\t\t\t\t \"select\":[\"Path\",\"select\"]\n\t\t\t\t},\n\t\t\t \"Layout\":{\"priority\":[\"Layout\",\"priority\"],\n\t\t\t\t   \"state\":[\"Layout\",\"state\"]}\n\t\t\t}; // overwrite state with default/url/setup, no-matter-what\n    this.init=function(state){\n\tvar par=\"setup\";\n\tstate.Utils.init(par,this);\n    };\n    this.loadDefault=function(state, callbacks ) {\n\tvar file=this.setup;\n\tconsole.log(\"Default setup:\",file);\n\tif (state.Threshold.thrs !== undefined) { // defaults already loaded, execute callback...\n\t    state.File.next(state,\"\",callbacks);\n\t} else {\n\t    var path=state.Default.dir + state.Default.setup;\n\t    state.File.load(state,path,callbacks);\n\t}\n    };\n    this.processDefault=function(state,response,callbacks) {\n\tif (state.Threshold.thrs !== undefined) { // defaults already loaded, execute callback...\n\t    state.File.next(state,\"\",callbacks);\n\t} else {\n\t    //console.log(\"Response:\",response);\n\t    try {\n\t\tvar json = JSON.parse(response);\n\t    } catch (e) {\n\t\talert(\"Default '\"+state.Default.setup+\"' contains Invalid JSON:\"+e.name+\":\"+e.message);\n\t    }\n\t    if (json !== undefined) {\n\t\t//console.log(\"state:\",JSON.stringify(state.Path));\n\n\t\tstate.Utils.mapFill(state,state.Default.JsonMapFill,state.Default,json);\n\t\tstate.Utils.mapForce(state,state.Default.JsonMapForce,state.Default,json);\n\t\tstate.Utils.mapFill(state,state.Default.DefaultMapFill,state,state.Default);\n\n\t\t//console.log(\"JSON:\",JSON.stringify(json.tooltip));\n\t\t//console.log(\"Default:\",JSON.stringify(state.Default.Path.tooltip));\n\t\t//console.log(\"State:\",JSON.stringify(state.Path.tooltip));\n\t\t\n\t    };\n\t    if (state.Default.start === undefined) {\n\t\tstate.Default.start={};\n\t\tstate.Utils.mapFill(state,state.Default.DefaultMapFill,state.Default.start,state);\n\t\t//state.Default.save(state);\n\t    }\n\t    // finally execute next callback\n\t    state.File.next(state,\"\",callbacks);\n\t}\n    };\n    this.getSetup=function(state) {\n\tvar setup=state.Utils.cp(state.Default.start);\n\t// get updated information\n\tstate.Utils.mapFill(state,state.Default.DefaultMapFill,setup,state);\n\t//JSON.stringify(setup, null, \"   \");\n\treturn setup;\n    };\n    this.save=function(state) {\n\tvar setup=state.Utils.prettyJson(state.Default.getSetup(state));\n\tstate.Utils.save(setup,\"setup.json\",\"json\");\n    };\n    this.hasChanged=function(state,main,item) {\n\tif (state.Default!==undefined && \n\t    state.Default[main]!==undefined &&\n\t    state.Default[main][item]!==undefined) {\n\t    var src=JSON.stringify(state[main][item]);\n\t    var trg=JSON.stringify(state.Default[main][item]);\n\t    //console.log(\"Checking:\",main,item,\"\\n\",src,\"\\n\",trg,\"->\",src!==trg);\n\t    return src!==trg;\n\t} else {\n\t    return true;\n\t}\n    };\n};\nexport default Default;\n"]},"metadata":{},"sourceType":"module"}