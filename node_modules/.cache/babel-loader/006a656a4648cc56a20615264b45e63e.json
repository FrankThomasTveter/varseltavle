{"ast":null,"code":"import _classCallCheck from \"/home/franktt/react/varseltavle/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";\nimport _createClass from \"/home/franktt/react/varseltavle/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"/home/franktt/react/varseltavle/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"/home/franktt/react/varseltavle/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/getPrototypeOf\";\nimport _inherits from \"/home/franktt/react/varseltavle/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";\nimport _objectWithoutProperties from \"/home/franktt/react/varseltavle/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectWithoutProperties\";\nvar _jsxFileName = \"/home/franktt/react/varseltavle/src/react/Table2DComponent.js\";\nimport React, { Component } from \"react\";\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\nimport Paper from '@material-ui/core/Paper';\nimport Grid from '@material-ui/core/Grid';\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableRow from '@material-ui/core/TableRow';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableCell from '@material-ui/core/TableCell';\nimport ReactDOM from 'react-dom';\nimport SummaryCell from './SummaryCell';\nimport SeriesCell from './SeriesCell'; //console.log(\"Inside Table.\")\n//        flexGrow: 1,\n\nvar styles = function styles(theme) {\n  return {\n    root: {\n      height: '100%',\n      maxWidth: '100%'\n    },\n    table: {\n      textAlign: 'left',\n      overflow: 'hidden'\n    },\n    row: {\n      margin: '100px'\n    },\n    cell: {\n      cursor: \"pointer\",\n      padding: theme.spacing.unit * 1,\n      width: theme.spacing.unit * 10\n    },\n    rotate: {\n      cursor: \"pointer\",\n      padding: theme.spacing.unit * 1,\n      width: theme.spacing.unit * 10\n    },\n    firstCell: {\n      cursor: \"pointer\",\n      padding: theme.spacing.unit * 1,\n      width: '100%'\n    }\n  };\n}; //\tmargin: '100px',\n//      padding: theme.spacing.unit * 0,\n//\tborderStyle: 'solid',\n//\tmaxWidth: '100px',\n\n\nfunction getWidthOfText(txt, fontname, fontsize) {\n  if (getWidthOfText.c === undefined) {\n    getWidthOfText.c = document.createElement('canvas');\n    getWidthOfText.ctx = getWidthOfText.c.getContext('2d');\n  }\n\n  getWidthOfText.ctx.font = fontsize + ' ' + fontname;\n  return getWidthOfText.ctx.measureText(txt).width;\n}\n\n;\n\nfunction rotateHeight(state, element) {\n  var gwidth, lheight, lwidth, oheight, owidth;\n  var gdd, dd, style;\n  var rotates = document.getElementsByClassName('rotate');\n  var j;\n  var children = document.getElementsByClassName('rotate');\n  var lenc = children.length;\n\n  for (j = 0; j < lenc; j++) {\n    console.log(\"Child:\", j, children[j]);\n  } //var rotates = document.getElementsByClassName('classname');\n  //console.log(\"Rotating heights.\",rotates.length);\n\n\n  var i;\n\n  for (i = 0; i < rotates.length; i++) {\n    lheight = parseInt(rotates[i].offsetWidth, 10);\n    lwidth = parseInt(rotates[i].offsetHeight, 10);\n\n    if (gwidth === undefined) {\n      gwidth = lwidth;\n    }\n\n    ;\n    oheight = lheight / 2;\n    owidth = lwidth / 2;\n    dd = oheight - owidth;\n\n    if (gdd === undefined) {\n      gdd = dd;\n    } else if (gdd < dd) {\n      gdd = dd;\n    }\n\n    console.log(\"Found rotate:\", i, rotates[i].innerHTML, oheight, owidth, gdd);\n  }\n\n  console.log(\"Pars:\", gdd, oheight, owidth, lenc); // 19px 129px\n\n  for (i = 0; i < rotates.length; i++) {\n    //var cwidth=parseInt(window.getComputedStyle(rotates[i]).fontSize,10);\n    lheight = parseInt(rotates[i].offsetWidth, 10);\n    lwidth = parseInt(rotates[i].offsetHeight, 10);\n    oheight = lheight / 2;\n    owidth = lwidth / 2;\n    dd = oheight - owidth;\n    style = \"width:\" + lwidth + \"px;height:\" + lheight + \"px;transform:translate(\" + dd + \"px,\" + gdd + \"px) rotate(-90.0deg);\";\n    console.log(\"Rotates:\", i, style, lwidth, lheight, dd, gdd, oheight, owidth); // 19px 129px\n    //rotates[i].setAttribute(\"style\",style);\n  }\n\n  var canvas = document.getElementsByClassName('canvas');\n\n  for (i = 0; i < canvas.length; i++) {\n    var cheight = parseInt(window.getComputedStyle(canvas[i]).fontSize, 10);\n    style = \"width:\" + gwidth + \"px;height:\" + cheight * 1.5 + \"px\"; //console.log(\"Canvas:\",i,style,gwidth);// 19px 129px\n\n    canvas[i].style.width = gwidth + \"px\";\n    canvas[i].style.height = cheight * 3 + \"px\";\n  }\n}\n\n;\n\nfunction getStep(state, colvalues, cellMode) {\n  var step = 1;\n\n  if (cellMode === state.Show.code.cell.Series) {\n    step = Math.max(1, Math.ceil(colvalues.length / 20));\n  }\n\n  return step;\n} // ---------------- DATA\n\n\nfunction FirstDataCell(props) {\n  var classes = props.classes,\n      rowval = props.rowval,\n      onclick = props.onclick,\n      title = props.title; //console.log(\"Making first data cell.\");\n\n  return React.createElement(TableCell, {\n    className: classes.firstCell,\n    onClick: onclick,\n    title: title,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  }, rowval);\n}\n\nfunction DataCell(props) {\n  var classes = props.classes,\n      state = props.state,\n      elements = props.elements,\n      mode = props.mode,\n      other = _objectWithoutProperties(props, [\"classes\", \"state\", \"elements\", \"mode\"]);\n\n  if (elements === undefined) {\n    return React.createElement(TableCell, {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 124\n      },\n      __self: this\n    });\n  } else if (mode === state.Show.code.cell.Sum) {\n    return React.createElement(SummaryCell, Object.assign({}, other, {\n      state: state,\n      elements: elements,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 126\n      },\n      __self: this\n    }));\n  } else {\n    return React.createElement(SeriesCell, Object.assign({}, other, {\n      state: state,\n      elements: elements,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 128\n      },\n      __self: this\n    }));\n  }\n}\n\nfunction renderDataCell(classes, state, colkey, colvalues, rowkey, rowval, rowindex, rowwhere, range, mode, step, val, index) {\n  var title = state.Database.getWhereDetail(colkey, colvalues[index]); //console.log(\"Making data cell:\",rowval,val,index,step,JSON.stringify(colvalues));\n\n  if ((index - 1) % step === 0) {\n    // get elements and range\n    var elements = state.Matrix.getMatrixElements(colvalues, rowval, state.React.matrix, index, step); // get count and colwhere\n\n    var cnt = Math.min(colvalues.length, index + step) - index;\n    var colwhere = state.Database.getColWhere(colkey, colvalues, index, step); // make onclick and title\n\n    var onclick = function onclick() {\n      return state.Navigate.selectItem(state, colkey, rowkey, colvalues[index], rowval, colwhere, rowwhere, cnt, 1);\n    };\n\n    return React.createElement(DataCell, {\n      className: classes.cell,\n      state: state,\n      key: \"col-\".concat(index),\n      index: index,\n      onclick: onclick,\n      title: title,\n      colkey: colkey,\n      rowkey: rowkey,\n      colvalues: colvalues,\n      colval: val,\n      rowval: rowval,\n      colwhere: colwhere,\n      rowwhere: rowwhere,\n      elements: elements,\n      mode: mode,\n      step: step,\n      range: range,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 142\n      },\n      __self: this\n    });\n  } else {\n    return null;\n  }\n}\n\nfunction dataRow(classes, state, colkey, rowkey, colvalues, mode, step, rowval, rowindex) {\n  var rowwhere = state.Database.getWhereDetail(rowkey, rowval);\n\n  var onclick = function onclick() {\n    return state.Navigate.selectKey(state, rowkey, rowval, rowwhere, 1);\n  };\n\n  var range = [undefined, undefined];\n\n  if (state.React.matrix !== undefined) {\n    range = state.Matrix.getRange(state, state.React.matrix, colvalues, [rowval]);\n  }\n\n  ; //console.log(\"Making data cols.\",colkey,JSON.stringify(colvalues));\n  //console.log(\"We have a matrix(\",rowval,\") with range:\",JSON.stringify(range));\n\n  var mapFunction = function mapFunction(val, index) {\n    return renderDataCell(classes, state, colkey, colvalues, rowkey, rowval, rowindex, rowwhere, range, mode, step, val, index);\n  };\n\n  return React.createElement(TableRow, {\n    key: rowindex.toString(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 159\n    },\n    __self: this\n  }, React.createElement(FirstDataCell, {\n    classes: classes,\n    key: '0',\n    rowval: rowval,\n    onclick: onclick,\n    title: rowwhere,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 160\n    },\n    __self: this\n  }), colvalues.map(mapFunction));\n}\n\n;\n\nfunction renderZeroRow(classes, state, colkey, colvalues, step) {\n  return React.createElement(TableRow, {\n    key: '1',\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 165\n    },\n    __self: this\n  }, React.createElement(TableCell, {\n    key: \"0\",\n    state: state,\n    index: '0',\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 166\n    },\n    __self: this\n  }, \"No data\"));\n}\n\n;\n\nfunction DataRows(props) {\n  var classes = props.classes,\n      state = props.state,\n      step = props.step,\n      colkey = props.colkey,\n      colvalues = props.colvalues,\n      rowkey = props.rowkey,\n      rowvalues = props.rowvalues,\n      mode = props.mode; //console.log(\"Making data cols.\",colkey,JSON.stringify(colvalues));\n\n  var mapFunction = function mapFunction(val, index) {\n    return dataRow(classes, state, colkey, rowkey, colvalues, mode, step, val, index);\n  };\n\n  if (rowvalues.length === 0) {\n    return renderZeroRow(classes, state, colkey, colvalues, step);\n  } else {\n    return rowvalues.map(mapFunction);\n  }\n} // ---------------- HDR\n\n\nfunction FirstHdrCell(props) {\n  var colkey = props.colkey,\n      rowkey = props.rowkey;\n  var label = rowkey + \"\\\\\" + colkey; //console.log(\"Making first header cell.\",label);\n\n  return React.createElement(TableCell, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184\n    },\n    __self: this\n  }, label);\n}\n\nfunction renderHdrCell(classes, state, colkey, colvalues, rowkey, step, val, index) {\n  if ((index - 1) % step === 0) {\n    //console.log(\"HdrCell:\",index,step);\n    var cnt = Math.min(colvalues.length, index + step) - index;\n    var colwhere = state.Database.getColWhere(colkey, colvalues, index, step);\n\n    var onclick = function onclick() {\n      return state.Navigate.selectKey(state, colkey, colvalues[index], colwhere, cnt);\n    };\n\n    var title = colwhere;\n    return React.createElement(TableCell, {\n      className: classes.cell,\n      id: \"rotate\",\n      key: \"col-\".concat(index),\n      index: index,\n      onClick: onclick,\n      title: title,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 193\n      },\n      __self: this\n    }, val);\n  } else {\n    return null;\n  }\n}\n\nfunction HdrRow(props) {\n  var classes = props.classes,\n      state = props.state,\n      step = props.step,\n      colkey = props.colkey,\n      colvalues = props.colvalues,\n      rowkey = props.rowkey; //, rowvalues\n  //console.log(\"Making header row.\",colkey,JSON.stringify(colvalues));\n\n  var mapFunction = function mapFunction(val, index) {\n    return renderHdrCell(classes, state, colkey, colvalues, rowkey, step, val, index);\n  };\n\n  return React.createElement(TableRow, {\n    key: 0,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 202\n    },\n    __self: this\n  }, React.createElement(FirstHdrCell, {\n    colkey: colkey,\n    rowkey: rowkey,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 203\n    },\n    __self: this\n  }), colvalues.map(mapFunction));\n} // ---------------- Details\n\n\nfunction Details(props) {\n  var classes = props.classes,\n      state = props.state; // classes, \n\n  var colkey = state.Path.getColKey(state) || \"\";\n  var rowkey = state.Path.getRowKey(state) || \"\";\n  var colvalues = state.Path.filterKeys(state, state.Matrix.values[colkey] || [\"\"]);\n  var rowvalues = state.Path.filterKeys(state, state.Matrix.values[rowkey] || [\"\"]);\n  var cellMode = state.Show.getCellMode(state);\n  var step = getStep(state, colvalues, cellMode); //console.log(\"Colkey:\",colkey,\" colval:\",JSON.stringify(state.Matrix.values[colkey]||[\"\"]));\n  //console.log(\"Rowkey:\",rowkey,\" rowval:\",JSON.stringify(state.Matrix.values[rowkey]||[\"\"]));\n\n  var ncol = colvalues.length + 1;\n  var nrow = rowvalues.length + 1; //DOM.style.font\n  //DOM.style.fontSize\n\n  console.log(\"Width/Height:\", window.innerWidth, window.innerHeight);\n  return React.createElement(Table, {\n    className: classes.table,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 225\n    },\n    __self: this\n  }, React.createElement(TableHead, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 226\n    },\n    __self: this\n  }, React.createElement(HdrRow, {\n    classes: classes,\n    state: state,\n    step: step,\n    colkey: colkey,\n    colvalues: colvalues,\n    rowkey: rowkey,\n    rowvalues: rowvalues,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227\n    },\n    __self: this\n  })), React.createElement(TableBody, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 229\n    },\n    __self: this\n  }, React.createElement(DataRows, {\n    classes: classes,\n    state: state,\n    step: step,\n    colkey: colkey,\n    colvalues: colvalues,\n    rowkey: rowkey,\n    rowvalues: rowvalues,\n    mode: cellMode,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 230\n    },\n    __self: this\n  })));\n} //<div  style={{width: '100%', height: '100%'}}>\n//</div>\n\n\nvar Table2D =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Table2D, _Component);\n\n  function Table2D(props) {\n    var _this;\n\n    _classCallCheck(this, Table2D);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Table2D).call(this, props));\n\n    _this.updateWindowDimensions = function () {\n      _this.width = window.innerWidth;\n      _this.height = window.innerHeight;\n      _this.bbx = _this.el.getBoundingClientRect();\n      console.log(\"Width/Height:\", _this.width, _this.height, _this.bbx.width, _this.bbx.height);\n    };\n\n    _this.state = props.state;\n    return _this;\n  }\n\n  _createClass(Table2D, [{\n    key: \"componentDidMount\",\n    value: function componentDidMount() {\n      window.addEventListener(\"resize\", this.updateWindowDimensions); // var height=window.innerHeight();\n      //console.log(\"Width/Height:\",window.innerWidth,window.innerHeight)\n\n      rotateHeight(this.state, ReactDOM.findDOMNode(this));\n    }\n  }, {\n    key: \"element\",\n    value: function element(el) {\n      if (el !== undefined && el !== null) {\n        this.el = el;\n        this.bbx = this.el.getBoundingClientRect();\n        console.log(\"BBX width/height:\", this.bbx.width, this.bbx.height);\n      }\n\n      ;\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      var _this2 = this;\n\n      var _this$props = this.props,\n          classes = _this$props.classes,\n          state = _this$props.state;\n      console.log(\"##### Rendering Table2D.\");\n      return React.createElement(\"div\", {\n        ref: function ref(el) {\n          _this2.element(el);\n        },\n        className: classes.root,\n        style: {\n          width: '100%',\n          height: '100%'\n        },\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 264\n        },\n        __self: this\n      }, React.createElement(Grid, {\n        container: true,\n        spacing: 24,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 265\n        },\n        __self: this\n      }, React.createElement(Grid, {\n        item: true,\n        xs: 12,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 266\n        },\n        __self: this\n      }, React.createElement(Paper, {\n        className: classes.table,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 267\n        },\n        __self: this\n      }, React.createElement(Details, {\n        state: state,\n        classes: classes,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 268\n        },\n        __self: this\n      })))));\n    }\n  }]);\n\n  return Table2D;\n}(Component);\n\nTable2D.propTypes = {\n  classes: PropTypes.object.isRequired\n};\nexport default withStyles(styles)(Table2D);","map":{"version":3,"sources":["/home/franktt/react/varseltavle/src/react/Table2DComponent.js"],"names":["React","Component","PropTypes","withStyles","Paper","Grid","Table","TableBody","TableRow","TableHead","TableCell","ReactDOM","SummaryCell","SeriesCell","styles","theme","root","height","maxWidth","table","textAlign","overflow","row","margin","cell","cursor","padding","spacing","unit","width","rotate","firstCell","getWidthOfText","txt","fontname","fontsize","c","undefined","document","createElement","ctx","getContext","font","measureText","rotateHeight","state","element","gwidth","lheight","lwidth","oheight","owidth","gdd","dd","style","rotates","getElementsByClassName","j","children","lenc","length","console","log","i","parseInt","offsetWidth","offsetHeight","innerHTML","canvas","cheight","window","getComputedStyle","fontSize","getStep","colvalues","cellMode","step","Show","code","Series","Math","max","ceil","FirstDataCell","props","classes","rowval","onclick","title","DataCell","elements","mode","other","Sum","renderDataCell","colkey","rowkey","rowindex","rowwhere","range","val","index","Database","getWhereDetail","Matrix","getMatrixElements","matrix","cnt","min","colwhere","getColWhere","Navigate","selectItem","dataRow","selectKey","getRange","mapFunction","toString","map","renderZeroRow","DataRows","rowvalues","FirstHdrCell","label","renderHdrCell","HdrRow","Details","Path","getColKey","getRowKey","filterKeys","values","getCellMode","ncol","nrow","innerWidth","innerHeight","Table2D","updateWindowDimensions","bbx","el","getBoundingClientRect","addEventListener","findDOMNode","propTypes","object","isRequired"],"mappings":"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","sourcesContent":["import React, {Component} from \"react\";\nimport PropTypes from 'prop-types';\nimport { withStyles } from '@material-ui/core/styles';\n\nimport Paper from '@material-ui/core/Paper';\nimport Grid from '@material-ui/core/Grid';\n\nimport Table from '@material-ui/core/Table';\nimport TableBody from '@material-ui/core/TableBody';\nimport TableRow from '@material-ui/core/TableRow';\nimport TableHead from '@material-ui/core/TableHead';\nimport TableCell from '@material-ui/core/TableCell';\nimport ReactDOM from 'react-dom';\n\nimport SummaryCell from './SummaryCell';\nimport SeriesCell from './SeriesCell';\n\n//console.log(\"Inside Table.\")\n\n//        flexGrow: 1,\nconst styles = theme => ({\n    root: {\n\theight: '100%',\n\tmaxWidth: '100%',\n    },\n    table: {\n        textAlign: 'left',\n\toverflow: 'hidden',\n    },\n    row  :{\tmargin: '100px',\n\t  },\n    cell : {\n\tcursor: \"pointer\",\n\tpadding: theme.spacing.unit*1,\n\twidth:theme.spacing.unit*10,\n    },\n    rotate : {\n\tcursor: \"pointer\",\n\tpadding: theme.spacing.unit*1,\n\twidth:theme.spacing.unit*10,\n    },\n    firstCell : {\n\tcursor: \"pointer\",\n\tpadding: theme.spacing.unit*1,\n\twidth:'100%',\n    },\n});\n//\tmargin: '100px',\n//      padding: theme.spacing.unit * 0,\n//\tborderStyle: 'solid',\n//\tmaxWidth: '100px',\n\nfunction getWidthOfText(txt, fontname, fontsize){\n    if(getWidthOfText.c === undefined){\n        getWidthOfText.c=document.createElement('canvas');\n        getWidthOfText.ctx=getWidthOfText.c.getContext('2d');\n    }\n    getWidthOfText.ctx.font = fontsize + ' ' + fontname;\n    return getWidthOfText.ctx.measureText(txt).width;\n};\nfunction rotateHeight(state,element) {\n    var gwidth,lheight,lwidth,oheight,owidth;\n    var gdd,dd,style;\n    var rotates=document.getElementsByClassName('rotate');\n    var j;\n    var children = document.getElementsByClassName('rotate');\n    var lenc=children.length;\n    for (j=0;j<lenc;j++) {\n\tconsole.log(\"Child:\",j,children[j]);\n    }\n    //var rotates = document.getElementsByClassName('classname');\n    //console.log(\"Rotating heights.\",rotates.length);\n    var i;\n    for (i = 0; i < rotates.length; i++) {\n        lheight=parseInt(rotates[i].offsetWidth,10);\n        lwidth=parseInt(rotates[i].offsetHeight,10);\n        if (gwidth  === undefined) {gwidth=lwidth;};\n        oheight=(lheight/2);\n        owidth=(lwidth/2);\n        dd=(oheight-owidth);\n        if (gdd  === undefined) {\n            gdd=dd;\n        } else if (gdd < dd) {\n            gdd=dd;\n        }\n\tconsole.log(\"Found rotate:\",i,rotates[i].innerHTML,oheight,owidth,gdd);\n    }\n    console.log(\"Pars:\",gdd,oheight,owidth,lenc);// 19px 129px\n    for (i = 0; i < rotates.length; i++) {\n        //var cwidth=parseInt(window.getComputedStyle(rotates[i]).fontSize,10);\n        lheight=parseInt(rotates[i].offsetWidth,10);\n        lwidth=parseInt(rotates[i].offsetHeight,10);\n        oheight=(lheight/2);\n        owidth=(lwidth/2);\n        dd=(oheight-owidth);\n        style=\"width:\"+lwidth+\"px;height:\"+lheight+\"px;transform:translate(\"+dd+\"px,\"+gdd+\"px) rotate(-90.0deg);\";\n        console.log(\"Rotates:\",i,style,lwidth,lheight,dd,gdd,oheight,owidth);// 19px 129px\n        //rotates[i].setAttribute(\"style\",style);\n    }\n    var canvas = document.getElementsByClassName('canvas');\n    for (i = 0; i < canvas.length; i++) {\n        var cheight=parseInt(window.getComputedStyle(canvas[i]).fontSize,10);\n        style=\"width:\"+gwidth+\"px;height:\"+cheight*1.5+\"px\";\n        //console.log(\"Canvas:\",i,style,gwidth);// 19px 129px\n        canvas[i].style.width=gwidth+\"px\";\n        canvas[i].style.height=(cheight*3)+\"px\";\n    }\n};\n\nfunction getStep(state,colvalues,cellMode) {\n    var step=1;\n    if (cellMode === state.Show.code.cell.Series) {step=Math.max(1,Math.ceil(colvalues.length/20));}\n    return step;\n}\n// ---------------- DATA\nfunction FirstDataCell (props) {\n    const { classes, rowval, onclick, title } = props;\n    //console.log(\"Making first data cell.\");\n    return (<TableCell className={classes.firstCell} onClick={onclick} title={title}>{rowval}</TableCell>);\n}\nfunction DataCell(props) {\n    const {classes,state,elements,mode,...other}=props;\n    if (elements===undefined) {\n\treturn <TableCell/>\n    } else if (mode===state.Show.code.cell.Sum) {\n\treturn <SummaryCell {...other} state={state} elements={elements}/>\n    } else {\n\treturn <SeriesCell {...other} state={state} elements={elements}/>\n    }\n}\nfunction renderDataCell(classes,state,colkey,colvalues,rowkey,rowval,rowindex,rowwhere,range,mode,step,val,index) {\n    var title=state.Database.getWhereDetail(colkey,colvalues[index]);\n    //console.log(\"Making data cell:\",rowval,val,index,step,JSON.stringify(colvalues));\n    if ((index-1)%step === 0) {\n\t// get elements and range\n\tvar elements=state.Matrix.getMatrixElements(colvalues,rowval,state.React.matrix,index,step);\n\t// get count and colwhere\n        var cnt = Math.min(colvalues.length,index+step)-index;\n        var colwhere = state.Database.getColWhere(colkey,colvalues,index,step);\n\t// make onclick and title\n\tvar onclick=() => state.Navigate.selectItem(state,colkey,rowkey,colvalues[index],rowval,colwhere,rowwhere,cnt,1);\n\treturn (<DataCell className={classes.cell} state={state} key={`col-${index}`} index={index} onclick={onclick} title={title} \n\t\tcolkey={colkey} rowkey={rowkey} colvalues={colvalues} colval={val} rowval={rowval} colwhere={colwhere} rowwhere={rowwhere} \n\t\telements={elements} mode={mode} step={step} range={range}/>);\n    } else {\n\treturn null;\n    }\n}\nfunction dataRow(classes,state,colkey,rowkey,colvalues,mode,step,rowval,rowindex) {\n    var rowwhere=state.Database.getWhereDetail(rowkey,rowval);\n    var onclick=() => state.Navigate.selectKey(state,rowkey,rowval,rowwhere,1);\n    var range=[undefined,undefined];\n    if (state.React.matrix!==undefined) {\n\trange=state.Matrix.getRange(state,state.React.matrix,colvalues,[rowval]);\n    };\n    //console.log(\"Making data cols.\",colkey,JSON.stringify(colvalues));\n    //console.log(\"We have a matrix(\",rowval,\") with range:\",JSON.stringify(range));\n    var mapFunction= (val,index)=>renderDataCell(classes,state,colkey,colvalues,rowkey,rowval,rowindex,rowwhere,range,mode,step,val,index);\n    return (<TableRow key={rowindex.toString()}>\n\t    <FirstDataCell classes={classes} key={'0'} rowval={rowval} onclick={onclick} title={rowwhere}/>\n\t    {colvalues.map(mapFunction)}\n\t    </TableRow>);\n};\nfunction renderZeroRow(classes,state,colkey,colvalues,step) {\n    return (<TableRow key={'1'}>\n\t    <TableCell  key={`0`} state={state} index={'0'}>No data</TableCell>\n\t    </TableRow>);\n};\nfunction DataRows(props) {\n    const { classes, state, step, colkey, colvalues, rowkey, rowvalues, mode } = props;\n    //console.log(\"Making data cols.\",colkey,JSON.stringify(colvalues));\n    var mapFunction= (val,index)=>dataRow(classes,state,colkey,rowkey,colvalues,mode,step,val,index);\n    if (rowvalues.length===0) {\n\treturn renderZeroRow(classes,state,colkey,colvalues,step);\n    } else {\n\treturn (rowvalues.map(mapFunction));\n    }\n}\n// ---------------- HDR\nfunction FirstHdrCell (props) {\n    const { colkey, rowkey } = props;\n    var label=rowkey + \"\\\\\" + colkey;\n    //console.log(\"Making first header cell.\",label);\n    return (<TableCell>{label}</TableCell>);\n}\nfunction renderHdrCell(classes,state,colkey,colvalues,rowkey,step,val,index) {\n    if ((index-1)%step === 0) {\n\t//console.log(\"HdrCell:\",index,step);\n        var cnt = Math.min(colvalues.length,index+step)-index;\n        var colwhere = state.Database.getColWhere(colkey,colvalues,index,step);\n\tvar onclick=() => state.Navigate.selectKey(state,colkey,colvalues[index],colwhere,cnt);\n\tvar title=colwhere;\n\treturn (<TableCell className={classes.cell} id={\"rotate\"} key={`col-${index}`} index={index} onClick={onclick} title={title}>{val}</TableCell>);\n    } else {\n\treturn null;\n    }\n}\nfunction HdrRow(props) {\n    const { classes, state, step, colkey, colvalues, rowkey } = props; //, rowvalues\n    //console.log(\"Making header row.\",colkey,JSON.stringify(colvalues));\n    var mapFunction= (val,index)=>renderHdrCell(classes,state,colkey,colvalues,rowkey,step,val,index);\n    return (<TableRow key={0}>\n\t      <FirstHdrCell colkey={colkey} rowkey={rowkey}/>\n\t      {colvalues.map(mapFunction)}\n\t     </TableRow>);\n}\n// ---------------- Details\nfunction Details(props) {\n    const { classes, state } = props; // classes, \n    var colkey = state.Path.getColKey(state)||\"\";\n    var rowkey = state.Path.getRowKey(state)||\"\";\n    var colvalues = state.Path.filterKeys(state,state.Matrix.values[colkey]||[\"\"]);\n    var rowvalues = state.Path.filterKeys(state,state.Matrix.values[rowkey]||[\"\"]);\n    var cellMode  = state.Show.getCellMode(state);\n    var step=getStep(state,colvalues,cellMode);\n    //console.log(\"Colkey:\",colkey,\" colval:\",JSON.stringify(state.Matrix.values[colkey]||[\"\"]));\n    //console.log(\"Rowkey:\",rowkey,\" rowval:\",JSON.stringify(state.Matrix.values[rowkey]||[\"\"]));\n    var ncol=colvalues.length + 1;\n    var nrow=rowvalues.length + 1;\n    //DOM.style.font\n    //DOM.style.fontSize\n\n    console.log(\"Width/Height:\",window.innerWidth,window.innerHeight)\n    \n    return (<Table className={classes.table}>\n\t    <TableHead>\n\t      <HdrRow classes={classes} state={state} step={step} colkey={colkey} colvalues={colvalues} rowkey={rowkey} rowvalues={rowvalues}/>\n\t    </TableHead>\n\t    <TableBody>\n\t      <DataRows classes={classes} state={state} step={step} colkey={colkey} colvalues={colvalues} rowkey={rowkey} rowvalues={rowvalues} mode={cellMode}/>\n\t    </TableBody>\n        </Table>);\n }\n//<div  style={{width: '100%', height: '100%'}}>\n//</div>\n        \nclass Table2D extends Component {\n    constructor(props) {\n\tsuper(props);\n\tthis.state=props.state;\n    }\n    componentDidMount() {\n        window.addEventListener(\"resize\", this.updateWindowDimensions);\n\t// var height=window.innerHeight();\n\t//console.log(\"Width/Height:\",window.innerWidth,window.innerHeight)\n\trotateHeight(this.state,ReactDOM.findDOMNode(this));\n    } \n    updateWindowDimensions = () => {\n        this.width= window.innerWidth;\n\tthis.height=window.innerHeight;\n\tthis.bbx=this.el.getBoundingClientRect();\n\tconsole.log(\"Width/Height:\",this.width,this.height,this.bbx.width,this.bbx.height)\n    };\n    element(el) {\n\tif (el !== undefined && el !== null) {\n\t    this.el=el;\n\t    this.bbx=this.el.getBoundingClientRect();\n\t    console.log(\"BBX width/height:\",this.bbx.width,this.bbx.height);\n\t};\n    };\n    render() {\n\tconst { classes, state } = this.props;\n\tconsole.log(\"##### Rendering Table2D.\");\n\treturn (<div ref={el=>{this.element(el)}} className={classes.root}  style={{width: '100%', height: '100%'}}>\n\t\t   <Grid container spacing={24}>\n\t\t      <Grid item xs={12} > \n                         { <Paper className={classes.table}>\n\t\t              <Details state={state} classes={classes}/>\n                           </Paper>}\n                      </Grid>\n                   </Grid>\n\t        </div>);\n    }\n}\n\nTable2D.propTypes = {\n    classes: PropTypes.object.isRequired,\n};\n\nexport default withStyles(styles)(Table2D);\n"]},"metadata":{},"sourceType":"module"}