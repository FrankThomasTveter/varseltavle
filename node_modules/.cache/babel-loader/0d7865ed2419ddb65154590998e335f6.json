{"ast":null,"code":"//console.log(\"Loading UtilsLib.js\");\nfunction Utils() {\n  this.version = \"1\";\n\n  this.invertArray = function (arr) {\n    var alen = arr.length;\n    var xlen = Math.floor(alen / 2);\n\n    for (var ii = 0; ii < xlen; ii++) {\n      var jj = alen - ii - 1;\n      var buff = arr[ii];\n      arr[ii] = arr[jj];\n      arr[jj] = buff;\n    }\n  };\n\n  this.invertedArray = function (arr) {\n    var ret = [];\n    var alen = arr.length;\n\n    for (var ii = alen - 1; ii >= 0; ii--) {\n      ret.push(arr[ii]);\n    }\n\n    return ret;\n  };\n\n  this.getMin = function (arr) {\n    var len = arr.length,\n        min = undefined;\n\n    while (len--) {\n      if (min === undefined || arr[len] < min) {\n        min = arr[len];\n      }\n    }\n\n    return min;\n  };\n\n  this.getMax = function (arr) {\n    var len = arr.length,\n        max = undefined;\n\n    while (len--) {\n      if (max === undefined || arr[len] > max) {\n        max = arr[len];\n      }\n    }\n\n    return max;\n  };\n\n  this.init = function (par, setup) {\n    var url = this.getUrlVars();\n\n    if (par in url) {\n      //console.log(par,url);\n      var code = decodeURIComponent(url[par]); //console.log(\"Processing url:\",code);\n\n      var newsetup = JSON.parse(code);\n\n      for (var ss in newsetup) {\n        if (newsetup[ss] !== undefined) {\n          setup[ss] = newsetup[ss];\n        }\n      } //console.log(\"new setup:\",JSON.stringify(setup));\n\n    } else {//console.log(\"No '\"+par+\"' in URL.\");\n      }\n  };\n\n  this.clean = function (arr) {\n    for (var ii = 0; ii < arr.length; ii++) {\n      if (arr[ii] === null || arr[ii] === \"\") {\n        arr.splice(ii, 1);\n      }\n    }\n\n    return arr;\n  };\n\n  this.moveTo = function (arr, src, trg) {\n    var isrc = arr.indexOf(src);\n    var itrg = arr.indexOf(trg);\n\n    if (isrc !== -1 && itrg !== -1) {\n      var csrc = arr.splice(isrc, 1);\n      this.spliceArray(arr, itrg, 0, csrc);\n    }\n  };\n\n  this.cpArray = function (sarr, tarr) {\n    var lent = tarr.length;\n\n    for (var ii = 0; ii < lent; ii++) {\n      var ind = sarr.indexOf(tarr[ii]);\n\n      if (ind === -1) {\n        sarr.push(tarr[ii]);\n      }\n    }\n  };\n\n  this.ppArray = function (sarr, tarr) {\n    var lent = tarr.length;\n\n    for (var ii = lent - 1; ii >= 0; ii--) {\n      var ind = sarr.indexOf(tarr[ii]);\n\n      if (ind === -1) {\n        this.spliceArray(sarr, 0, 0, tarr[ii]); // first position (table)\n      }\n    }\n  };\n\n  this.addArray = function (sarr, tarr) {\n    this.cpArray(sarr, tarr);\n    tarr = [];\n  };\n\n  this.prepArray = function (sarr, tarr) {\n    this.ppArray(sarr, tarr);\n    tarr = [];\n  };\n\n  this.remArray = function (sarr, tarr) {\n    var lent = tarr.length;\n\n    for (var ii = 0; ii < lent; ii++) {\n      var ind = sarr.indexOf(tarr[ii]);\n\n      if (ind == -1) {\n        sarr.splice(ind, 0);\n      }\n    }\n  };\n\n  this.moveToArray = function (sarr, tarr, key, tpos) {\n    var sid = sarr.indexOf(key);\n\n    if (sid !== -1) {\n      var src = sarr.splice(sid, 1); // remove from path\n\n      if (tpos === undefined || tpos < 0) {\n        this.spliceArray(tarr, tarr.length, 0, src);\n      } else {\n        this.spliceArray(tarr, tpos, 0, src);\n      }\n\n      return true;\n    } else {\n      return false;\n    }\n  };\n\n  this.missing = function (arr, src) {\n    //console.log(\"Missing:\",src,JSON.stringify(arr));\n    if (arr === undefined) {\n      console.log(\"Invalid array specified in this.missing:\", JSON.stringify(src));\n      return false;\n    } else {\n      if (Array.isArray(src)) {\n        return arr.indexOf(src[0]) === -1;\n      } else {\n        return arr.indexOf(src) === -1;\n      }\n    }\n  };\n\n  this.restore = function (arr, obj) {\n    for (var key in obj) {\n      if (Object.prototype.hasOwnProperty.call(obj, key)) {\n        arr[key] = this.cp(obj[key]);\n      }\n    }\n\n    ;\n  };\n\n  this.cp = function (obj) {\n    if (obj === null || typeof obj !== 'object' || 'isActiveClone' in obj) return obj;\n    var temp;\n\n    if (obj instanceof Date) {\n      temp = new obj.constructor(); //or new Date(obj);\n    } else {\n      temp = obj.constructor();\n    }\n\n    ;\n\n    for (var key in obj) {\n      if (Object.prototype.hasOwnProperty.call(obj, key)) {\n        obj['isActiveClone'] = null;\n        temp[key] = this.cp(obj[key]);\n        delete obj['isActiveClone'];\n      }\n    }\n\n    return temp;\n  }.bind(this);\n\n  this.getStatusString = function (state) {\n    return this.numberWithCommas(state.Database.cnt) + \" in database, \" + this.numberWithCommas(state.Matrix.cnt) + \" in table.\";\n  };\n\n  this.toString = function (setup) {\n    var s = \"->\";\n\n    for (var kk in setup) {\n      s = s + \"|\" + kk + \":\" + setup[kk];\n    }\n\n    ;\n    return s;\n  };\n\n  this.numberWithCommas = function (x) {\n    return x.toString().replace(/\\B(state,?=(\\d{3})+(?!\\d))/g, \",\");\n  };\n\n  this.cntDocs = function (elements, key, val) {\n    var cnt = 0;\n    var elen = elements.length;\n\n    for (var ee = 0; ee < elen; ee++) {\n      // loop over elements\n      var el = elements[ee];\n      var docs = el.docs;\n      var dlen = docs.length;\n\n      if (val === \"\") {\n        cnt = cnt + dlen;\n      } else {\n        for (var jj = 0; jj < dlen; jj++) {\n          // loop over segments in each element\n          var d = docs[jj];\n          var thr = d._thr; //console.log(\"cntDocs:\",key,d[key],val,dlen);\n\n          if (d[key] === val) {\n            if (thr.val !== undefined) {\n              cnt = cnt + 1;\n            }\n\n            ;\n          }\n        }\n      }\n    } //console.log(\"cntDocs:\",JSON.stringify(elements),key,cnt,elen);\n\n\n    return cnt;\n  };\n\n  this.pushUrl = function (state) {\n    var path = window.location.pathname; //console.log(\"Path:\",path);\n\n    var page = path.split(\"/\").pop();\n    page.split('#').shift(); //console.log( page );\n\n    var url = page + \"?v=\" + this.version + \"&\"; //console.log(\"Actual Keys:\",JSON.stringify(state.Path.keys));\n\n    var urlPath = undefined;\n\n    if (state.Default.hasChanged(state, \"Path\", \"keys\")) {\n      if (urlPath === undefined) {\n        urlPath = {};\n      }\n\n      urlPath.keys = this.cp(state.Path.keys);\n    }\n\n    ;\n\n    if (state.Default.hasChanged(state, \"Path\", \"select\")) {\n      if (urlPath === undefined) {\n        urlPath = {};\n      }\n\n      urlPath.select = this.cp(state.Path.select);\n    }\n\n    ;\n\n    if (state.Default.hasChanged(state, \"Path\", \"home\")) {\n      if (urlPath === undefined) {\n        urlPath = {};\n      }\n\n      urlPath.home = this.cp(state.Path.home);\n    }\n\n    ;\n\n    if (state.Default.hasChanged(state, \"Path\", \"order\")) {\n      if (urlPath === undefined) {\n        urlPath = {};\n      }\n\n      urlPath.order = this.cp(state.Path.order);\n    }\n\n    ; //console.log(\"URL Keys:\",JSON.stringify(urlPath.keys));\n\n    var urlLayout = undefined;\n\n    if (state.Default.hasChanged(state, \"Layout\", \"priority\")) {\n      if (urlLayout === undefined) {\n        urlLayout = {};\n      }\n\n      urlLayout.priority = state.Layout.getPriority(state);\n    }\n\n    ;\n\n    if (state.Default.hasChanged(state, \"Layout\", \"state\")) {\n      if (urlLayout === undefined) {\n        urlLayout = {};\n      }\n\n      urlLayout.state = state.Layout.state;\n    }\n\n    ;\n\n    if (urlPath !== undefined) {\n      url = url + \"Path=\" + encodeURI(JSON.stringify(urlPath) + \"&\");\n    }\n\n    ;\n\n    if (urlLayout !== undefined) {\n      url = url + \"Layout=\" + encodeURI(JSON.stringify(urlLayout) + \"&\");\n    }\n\n    ; //console.log(\"Setting URL to:\",url,JSON.stringify(urlLayout));\n\n    window.history.replaceState(\"\", \"js\", url);\n  }.bind(this);\n\n  this.getUrlVars = function (state) {\n    var vars = {};\n    window.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi, function (m, key, value) {\n      //console.log(\"URL item:\",key,\" \",value)\n      vars[key] = value;\n    });\n\n    if (vars[\"v\"] !== this.version) {\n      return {};\n    } else {\n      return vars;\n    }\n\n    ;\n  };\n\n  this.uniq = function (state, a) {\n    var seen = {};\n    return a.filter(function (item) {\n      return seen.hasOwnProperty(item) ? false : seen[item] = true;\n    });\n  };\n\n  this.pushKey = function (arr, key, pos) {\n    if (Array.isArray(key)) {\n      var len = key.length;\n\n      for (var ii = 0; ii < len; ii++) {\n        if (arr.indexOf(key[ii]) === -1) {\n          if (pos === undefined) {\n            arr.push(key[ii]);\n          } else {\n            arr.splice(pos, 0, key[ii]);\n          }\n\n          ;\n        }\n      }\n    } else {\n      if (arr.indexOf(key) === -1) {\n        if (pos === undefined) {\n          arr.push(key);\n        } else {\n          arr.splice(pos, 0, key);\n        }\n\n        ;\n      }\n    }\n\n    this.clean(arr);\n  };\n\n  this.spliceArray = function (arr, index, n, child) {\n    if (Array.isArray(child)) {\n      var len = child.length;\n\n      for (var ii = 0; ii < len; ii++) {\n        arr.splice(index, n, child[ii]);\n        n = 0;\n        index = index + 1;\n      }\n    } else {\n      arr.splice(index, n, child);\n    }\n  };\n\n  this.ascendingArr = function (a, b) {\n    if (a[0] === \"\") {\n      return 1;\n    } else if (b[0] === \"\") {\n      return -1;\n    } else if (a[0] < b[0]) {\n      return -1;\n    } else if (a[0] > b[0]) {\n      return 1;\n    } else {\n      return 0;\n    }\n  };\n\n  this.descendingArr = function (a, b) {\n    if (a[0] === \"\") {\n      return -1;\n    } else if (b[0] === \"\") {\n      return 1;\n    } else if (a[0] < b[0]) {\n      return 1;\n    } else if (a[0] > b[0]) {\n      return -1;\n    } else {\n      return 0;\n    }\n  };\n\n  this.ascending = function (a, b) {\n    if (a === \"\") {\n      return 1;\n    } else if (b === \"\") {\n      return -1;\n    } else if (a < b) {\n      return -1;\n    } else if (a > b) {\n      return 1;\n    } else {\n      return 0;\n    }\n  };\n\n  this.descending = function (a, b) {\n    if (a === \"\") {\n      return -1;\n    } else if (b === \"\") {\n      return 1;\n    } else if (a < b) {\n      return 1;\n    } else if (a > b) {\n      return -1;\n    } else {\n      return 0;\n    }\n  };\n\n  this.ascendingN = function (a, b) {\n    if (a === null) {\n      return 1;\n    } else if (b === null) {\n      return -1;\n    } else if (Number(a) < Number(b)) {\n      return -1;\n    } else if (Number(a) > Number(b)) {\n      return 1;\n    } else {\n      return 0;\n    }\n  };\n\n  this.descendingN = function (a, b) {\n    if (a === null) {\n      return -1;\n    } else if (b === null) {\n      return 1;\n    } else if (Number(a) < Number(b)) {\n      return 1;\n    } else if (Number(a) > Number(b)) {\n      return -1;\n    } else {\n      return 0;\n    }\n  };\n}\n\n;\nexport default Utils;","map":{"version":3,"sources":["/home/franktt/react/varseltavle/src/lib/UtilsLib.js"],"names":["Utils","version","invertArray","arr","alen","length","xlen","Math","floor","ii","jj","buff","invertedArray","ret","push","getMin","len","min","undefined","getMax","max","init","par","setup","url","getUrlVars","code","decodeURIComponent","newsetup","JSON","parse","ss","clean","splice","moveTo","src","trg","isrc","indexOf","itrg","csrc","spliceArray","cpArray","sarr","tarr","lent","ind","ppArray","addArray","prepArray","remArray","moveToArray","key","tpos","sid","missing","console","log","stringify","Array","isArray","restore","obj","Object","prototype","hasOwnProperty","call","cp","temp","Date","constructor","bind","getStatusString","state","numberWithCommas","Database","cnt","Matrix","toString","s","kk","x","replace","cntDocs","elements","val","elen","ee","el","docs","dlen","d","thr","_thr","pushUrl","path","window","location","pathname","page","split","pop","shift","urlPath","Default","hasChanged","keys","Path","select","home","order","urlLayout","priority","Layout","getPriority","encodeURI","history","replaceState","vars","href","m","value","uniq","a","seen","filter","item","pushKey","pos","index","n","child","ascendingArr","b","descendingArr","ascending","descending","ascendingN","Number","descendingN"],"mappings":"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","sourcesContent":["//console.log(\"Loading UtilsLib.js\");\n\t\t    \nfunction Utils() {\n    this.version=\"1\";\n    this.invertArray=function(arr) {\n\tvar alen=arr.length;\n\tvar xlen=Math.floor(alen/2);\n\tfor (var ii=0; ii<xlen;ii++) {\n\t    var jj=alen-ii-1\n\t    var buff=arr[ii];\n\t    arr[ii]=arr[jj];\n\t    arr[jj]=buff;\n\t}\n    };\n    this.invertedArray=function(arr) {\n\tvar ret=[];\n\tvar alen=arr.length;\n\tfor (var ii=alen-1; ii>=0;ii--) {\n\t    ret.push(arr[ii]);\n\t}\n\treturn ret;\n    };\n    this.getMin=function(arr) {\n\tvar len = arr.length, min = undefined;\n\twhile (len--) {\n\t    if (min === undefined || arr[len] < min) {\n\t\tmin = arr[len];\n\t    }\n\t}\n\treturn min;\n    };\n    this.getMax=function(arr) {\n\tvar len = arr.length, max = undefined;\n\twhile (len--) {\n\t    if (max === undefined || arr[len] > max) {\n\t\tmax = arr[len];\n\t    }\n\t}\n\treturn max;\n    };\n    this.init=function(par,setup){\n\tvar url=this.getUrlVars();\n\tif (par in url) {\n\t    //console.log(par,url);\n\t    var code=decodeURIComponent(url[par]);\n\t    //console.log(\"Processing url:\",code);\n\t    var newsetup=JSON.parse(code);\n\t    for (var ss in newsetup) {\n\t\tif (newsetup[ss] !== undefined) {\n\t\t    setup[ss]=newsetup[ss];\n\t\t}\n\t    }\n\t    //console.log(\"new setup:\",JSON.stringify(setup));\n\t} else {\n\t    //console.log(\"No '\"+par+\"' in URL.\");\n\t}\n\n    };\n    this.clean=function(arr) {\n\tfor (var ii=0;ii<arr.length;ii++) {\n\t    if (arr[ii]===null || arr[ii]===\"\") {\n\t\tarr.splice(ii, 1);\n\t    }\n\t}\n\treturn arr;\n    }\n    this.moveTo=function(arr,src,trg) {\n\tvar isrc=arr.indexOf(src);\n\tvar itrg=arr.indexOf(trg);\n\tif (isrc !== -1 && itrg !== -1) {\n\t    var csrc=arr.splice(isrc, 1);\n\t    this.spliceArray(arr,itrg,0,csrc);\n\t}\n    };\n    this.cpArray=function(sarr,tarr) {\n\tvar lent=tarr.length;\n\tfor (var ii=0;ii<lent;ii++) {\n\t    var ind=sarr.indexOf(tarr[ii]);\n\t    if (ind===-1) {\n\t\tsarr.push(tarr[ii]);\n\t    }\n\t}\n    };\n    this.ppArray=function(sarr,tarr) {\n\tvar lent=tarr.length;\n\tfor (var ii=lent-1;ii>=0;ii--) {\n\t    var ind=sarr.indexOf(tarr[ii]);\n\t    if (ind===-1) {\n\t\tthis.spliceArray(sarr,0,0,tarr[ii]); // first position (table)\n\t    }\n\t}\n    };\n    this.addArray=function(sarr,tarr) {\n\tthis.cpArray(sarr,tarr);\n\ttarr=[];\n    };\n    this.prepArray=function(sarr,tarr) {\n\tthis.ppArray(sarr,tarr);\n\ttarr=[];\n    };\n    this.remArray=function(sarr,tarr) {\n\tvar lent=tarr.length;\n\tfor (var ii=0;ii<lent;ii++) {\n\t    var ind=sarr.indexOf(tarr[ii]);\n\t    if (ind==-1) {\n\t\tsarr.splice(ind,0);\n\t    }\n\t}\n    };\n    this.moveToArray=function(sarr,tarr,key,tpos) {\n\tvar sid=sarr.indexOf(key);\n\tif (sid !== -1) {\n\t    var src=sarr.splice(sid, 1);    // remove from path\n\t    if (tpos  === undefined || tpos  < 0) {\n\t\tthis.spliceArray(tarr,tarr.length, 0, src);\n\t    } else {\n\t\tthis.spliceArray(tarr,tpos, 0, src);\n\t    }\n\t    return true;\n\t}else {\n\t    return false;\n\t}\n    };\n    this.missing=function(arr,src){\n\t//console.log(\"Missing:\",src,JSON.stringify(arr));\n\tif (arr === undefined) {\n\t    console.log(\"Invalid array specified in this.missing:\",JSON.stringify(src));\n\t    return false;\n\t} else {\n\t    if (Array.isArray(src)) {\n\t\treturn (arr.indexOf(src[0])  === -1);\n\t    } else {\n\t\treturn (arr.indexOf(src)  === -1);\n\t    }\n\t}\n    };\n    this.restore=function(arr,obj) {\n\tfor (var key in obj) {\n            if (Object.prototype.hasOwnProperty.call(obj, key)) {\n\t\tarr[key]=this.cp(obj[key]);\n\t    }\n\t};\n    };\n    this.cp=function(obj) {\n\tif (obj === null || typeof (obj) !== 'object' || 'isActiveClone' in obj)\n            return obj;\n\tvar temp;\n\tif (obj instanceof Date) {\n\t    temp = new obj.constructor(); //or new Date(obj);\n\t} else {\n\t    temp = obj.constructor();\n\t};\n\tfor (var key in obj) {\n            if (Object.prototype.hasOwnProperty.call(obj, key)) {\n\t\tobj['isActiveClone'] = null;\n\t\ttemp[key] = this.cp(obj[key]);\n\t\tdelete obj['isActiveClone'];\n            }\n\t}\n\treturn temp;\n    }.bind(this);\n    this.getStatusString=function(state) {\n\treturn this.numberWithCommas(state.Database.cnt)+ \" in database, \"+\n\t    this.numberWithCommas(state.Matrix.cnt)+\" in table.\";\n    };\n    this.toString=function(setup) {\n\tvar s=\"->\";\n\tfor (var kk in setup) {\n\t    s = s + \"|\"+ kk + \":\" + setup[kk];\n\t};\n\treturn s;\n    };\n    this.numberWithCommas=function(x) {\n\treturn x.toString().replace(/\\B(state,?=(\\d{3})+(?!\\d))/g, \",\");\n    };\n    this.cntDocs=function(elements,key,val) {\n\tvar cnt=0;\n\tvar elen=elements.length;\n\tfor (var ee=0;ee<elen;ee++) {   // loop over elements\n\t    var el=elements[ee];\n\t    var docs=el.docs;\n\t    var dlen=docs.length;\n\t    if (val===\"\") {\n\t\tcnt=cnt+dlen;\n\t    } else {\n\t\tfor (var jj=0;jj<dlen;jj++) {   // loop over segments in each element\n\t\t    var d=docs[jj];\n\t\t    var thr=d._thr;\n\t\t    //console.log(\"cntDocs:\",key,d[key],val,dlen);\n\t\t    if (d[key]===val) {\n\t\t\tif (thr.val !== undefined) {\n\t\t\t    cnt=cnt+1;\n\t\t\t};\n\t\t    }\n\t\t}\n\t    }\n\t}\n\t//console.log(\"cntDocs:\",JSON.stringify(elements),key,cnt,elen);\n\treturn cnt;\n    };\n    this.pushUrl=function(state) {\n\tvar path = window.location.pathname;\n\t//console.log(\"Path:\",path);\n\tvar page = path.split(\"/\").pop();\n\tpage.split('#').shift();\n\t//console.log( page );\n\tvar url=page+\"?v=\"+this.version+\"&\";\n\t//console.log(\"Actual Keys:\",JSON.stringify(state.Path.keys));\n\tvar urlPath=undefined;\n\tif (state.Default.hasChanged(state,\"Path\",\"keys\")) {\n\t    if (urlPath ===undefined) {urlPath={};}\n\t    urlPath.keys=this.cp(state.Path.keys);\n\t};\n\tif (state.Default.hasChanged(state,\"Path\",\"select\")) {\n\t    if (urlPath ===undefined) {urlPath={};}\n\t    urlPath.select=this.cp(state.Path.select);\n\t};\n\tif (state.Default.hasChanged(state,\"Path\",\"home\")) {\n\t    if (urlPath ===undefined) {urlPath={};}\n\t    urlPath.home=this.cp(state.Path.home);\n\t};\n\tif (state.Default.hasChanged(state,\"Path\",\"order\")) {\n\t    if (urlPath ===undefined) {urlPath={};}\n\t    urlPath.order=this.cp(state.Path.order);\n\t};\n\t//console.log(\"URL Keys:\",JSON.stringify(urlPath.keys));\n\tvar urlLayout=undefined;\n\tif (state.Default.hasChanged(state,\"Layout\",\"priority\")) {\n\t    if (urlLayout ===undefined) {urlLayout={};}\n\t    urlLayout.priority=state.Layout.getPriority(state);\n\t};\n\tif (state.Default.hasChanged(state,\"Layout\",\"state\")) {\n\t    if (urlLayout ===undefined) {urlLayout={};}\n\t    urlLayout.state=state.Layout.state;\n\t};\n\tif (urlPath !== undefined) {\n\t    url=url + \"Path=\" + encodeURI(JSON.stringify(urlPath)+\"&\");\n\t};\n\tif (urlLayout !== undefined) {\n\t    url=url + \"Layout=\" + encodeURI(JSON.stringify(urlLayout)+\"&\");\n\t};\n\t//console.log(\"Setting URL to:\",url,JSON.stringify(urlLayout));\n\twindow.history.replaceState(\"\", \"js\", url);\n    }.bind(this);\n    this.getUrlVars=function(state) {\n\tvar vars = {};\n\twindow.location.href.replace(/[?&]+([^=&]+)=([^&]*)/gi,    \n\t\t\t\t     function(m,key,value) {\n\t\t\t\t\t //console.log(\"URL item:\",key,\" \",value)\n\t\t\t\t\t vars[key] = value;\n\t\t\t\t     });\n\tif (vars[\"v\"]!==this.version) {\n\t    return {};\n\t} else {\n\t    return vars;\n\t};\n    };\n    this.uniq=function(state,a) {\n\tvar seen = {};\n\treturn a.filter(function(item) {\n\t    return seen.hasOwnProperty(item) ? false : (seen[item] = true);\n\t});\n    };\n    this.pushKey=function(arr,key,pos) {\n\tif (Array.isArray(key)) {\n\t    var len=key.length;\n\t    for (var ii=0; ii<len; ii++) {\n\t\tif (arr.indexOf(key[ii])===-1) {\n\t\t    if (pos === undefined) {\n\t\t\tarr.push(key[ii]);\n\t\t    } else {\n\t\t\tarr.splice(pos,0,key[ii])\n\t\t    };\n\t\t    \n\t\t}\n\t    }\n\t} else {\n\t    if (arr.indexOf(key)===-1) {\n\t\tif (pos === undefined) {\n\t\t    arr.push(key);\n\t\t} else {\n\t\t    arr.splice(pos,0,key)\n\t\t};\n\t    }\n\t}\n\tthis.clean(arr);\n    };\n    this.spliceArray=function(arr,index,n,child){\n\tif (Array.isArray(child)) {\n\t    var len=child.length;\n\t    for (var ii=0; ii<len; ii++) {\n\t\tarr.splice(index,n,child[ii])\n\t\tn=0\n\t\tindex=index+1\n\t    }\n\t} else {\n\t    arr.splice(index,n,child)\n\t}\n    }\n    this.ascendingArr=function(a,b) {\n\tif (a[0]  === \"\") { \n\t    return 1;\n\t} else if (b[0]  === \"\") {\n\t    return -1;\n\t} else if (a[0]<b[0]) { \n\t    return -1;\n\t} else if (a[0]>b[0]) {\n\t    return 1;\n\t} else {\n\t    return 0;\n\t}\n    };\n    this.descendingArr=function(a,b) {\n\tif (a[0]  === \"\") { \n\t    return -1;\n\t} else if (b[0]  === \"\") {\n\t    return 1;\n\t} else if (a[0]<b[0]) { \n\t    return 1;\n\t} else if (a[0]>b[0]) {\n\t    return -1;\n\t} else {\n\t    return 0;\n\t}\n    };\n    this.ascending=function(a,b) {\n\tif (a  === \"\") { \n\t    return 1;\n\t} else if (b  === \"\") {\n\t    return -1;\n\t} else if (a<b) { \n\t    return -1;\n\t} else if (a>b) {\n\t    return 1;\n\t} else {\n\t    return 0;\n\t}\n    };\n    this.descending=function(a,b) {\n\tif (a  === \"\") { \n\t    return -1;\n\t} else if (b  === \"\") {\n\t    return 1;\n\t} else if (a<b) { \n\t    return 1;\n\t} else if (a>b) {\n\t    return -1;\n\t} else {\n\t    return 0;\n\t}\n    };\n    this.ascendingN=function(a,b) {\n\tif (a  === null) { \n\t    return 1;\n\t} else if (b  === null) {\n\t    return -1;\n\t} else if (Number(a)<Number(b)) { \n\t    return -1;\n\t} else if (Number(a)>Number(b)) {\n\t    return 1;\n\t} else {\n\t    return 0;\n\t}\n    };\n    this.descendingN=function(a,b) {\n\tif (a  === null) { \n\t    return -1;\n\t} else if (b  === null) {\n\t    return 1;\n\t} else if (Number(a)<Number(b)) { \n\t    return 1;\n\t} else if (Number(a)>Number(b)) {\n\t    return -1;\n\t} else {\n\t    return 0;\n\t}\n    }\n};\nexport default Utils;\n"]},"metadata":{},"sourceType":"module"}