{"ast":null,"code":"//console.log(\"Loading FileLib.js\");\nfunction File(){this.ready=true;this.next=function(state,response,callbacks){//console.log(\"Next:\",JSON.stringify(callbacks));\nif(callbacks!==undefined){var callback=callbacks.shift();if(callback!==undefined){setTimeout(callback(state,response,callbacks),0.1);}}};this.load=function(state,file,callbacks){//console.log(\"Loading:\",JSON.stringify(file),JSON.stringify(callbacks));\nif(state.File.ready){// make sure we do not re-load if we are already loading\nstate.File.ready=false;state.Html.setFootnote(state,\"Server-request: \"+file);state.Html.setProgress(state,true);var regHttp=new XMLHttpRequest();regHttp.addEventListener(\"progress\",function(e){return state.Html.progressInfo(state,e);});//regHttp.addEventListener(\"load\",(e)=>state.Html.loadInfo(state,e));\nregHttp.addEventListener(\"error\",function(e){return state.Html.errorInfo(state,e);});regHttp.addEventListener(\"abort\",function(e){return state.Html.abortInfo(state,e);});regHttp.onreadystatechange=function(){state.File.ready=true;if(regHttp.readyState===4){if(regHttp.status===200){//console.log(regHttp.responseText);\nvar response=regHttp.responseText;//console.log(\"Ready:\",file,regHttp.readyState,regHttp.status,JSON.stringify(response))\nstate.File.next(state,response,callbacks);}else{state.Html.setFootnote(state,\"Unable to load \"+file);state.Html.setProgress(state,false);//state.Html.setConsole(file+\" error\");\n}}else{state.Html.setFootnote(state,file+\" error\");state.Html.setProgress(state,false);};};regHttp.responseType=\"\";regHttp.overrideMimeType(\"text/text\");//console.log(\"Http file:\",JSON.stringify(file));\nregHttp.open(\"GET\",file,true);regHttp.setRequestHeader('cache-control','no-cache, must-revalidate, post-check=0, pre-check=0');regHttp.setRequestHeader('cache-control','max-age=0');regHttp.setRequestHeader('expires','0');regHttp.setRequestHeader('expires','Tue, 01 Jan 1980 1:00:00 GMT');regHttp.setRequestHeader('pragma','no-cache');regHttp.send();}else{//state.Html.setConsole(\"\");\nstate.Html.setFootnote(state,\"Already waiting for reply...\");state.Html.setProgress(state,true);};};};export default File;","map":{"version":3,"sources":["/home/franktt/react/varseltavle/src/lib/FileLib.js"],"names":["File","ready","next","state","response","callbacks","undefined","callback","shift","setTimeout","load","file","Html","setFootnote","setProgress","regHttp","XMLHttpRequest","addEventListener","e","progressInfo","errorInfo","abortInfo","onreadystatechange","readyState","status","responseText","responseType","overrideMimeType","open","setRequestHeader","send"],"mappings":"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","sourcesContent":["//console.log(\"Loading FileLib.js\");\n\nfunction File() {\n    this.ready=true;\n    this.next=function(state, response, callbacks ) {\n\t//console.log(\"Next:\",JSON.stringify(callbacks));\n\tif (callbacks !== undefined) {\n\t    var callback=callbacks.shift();\n\t    if (callback !== undefined) {\n\t\tsetTimeout(callback(state,response,callbacks),0.1);\n\t    }\n\t}\n    }\n    this.load=function(state, file, callbacks ) {\n\t//console.log(\"Loading:\",JSON.stringify(file),JSON.stringify(callbacks));\n\tif (state.File.ready) { // make sure we do not re-load if we are already loading\n\t    state.File.ready=false;\n\t    state.Html.setFootnote(state, \"Server-request: \"+file);\n\t    state.Html.setProgress(state, true);\n\t    var regHttp = new XMLHttpRequest();\n\t    regHttp.addEventListener(\"progress\",(e)=>state.Html.progressInfo(state,e));\n\t    //regHttp.addEventListener(\"load\",(e)=>state.Html.loadInfo(state,e));\n\t    regHttp.addEventListener(\"error\",(e)=>state.Html.errorInfo(state,e));\n\t    regHttp.addEventListener(\"abort\",(e)=>state.Html.abortInfo(state,e));\n\t    regHttp.onreadystatechange = function() {\n\t\tstate.File.ready=true;\n\t\tif (regHttp.readyState  === 4) {\n\t\t    if (regHttp.status  === 200) {\n\t\t\t//console.log(regHttp.responseText);\n\t\t\tvar response = regHttp.responseText;\n\t\t\t//console.log(\"Ready:\",file,regHttp.readyState,regHttp.status,JSON.stringify(response))\n\t\t\tstate.File.next(state,response,callbacks);\n\t\t    } else {\n\t\t\tstate.Html.setFootnote(state,\"Unable to load \"+file);\n\t\t\tstate.Html.setProgress(state, false);\n\t\t\t//state.Html.setConsole(file+\" error\");\n\t\t    }\n\t\t} else {\n\t\t    state.Html.setFootnote(state,file+\" error\");\t\t\n\t\t    state.Html.setProgress(state, false);\n\t\t};\n\t    };\n\t    regHttp.responseType=\"\";\n\t    regHttp.overrideMimeType(\"text/text\");\n\t    //console.log(\"Http file:\",JSON.stringify(file));\n\t    regHttp.open(\"GET\", file, true);\n\t    regHttp.setRequestHeader('cache-control', 'no-cache, must-revalidate, post-check=0, pre-check=0');\n\t    regHttp.setRequestHeader('cache-control', 'max-age=0');\n\t    regHttp.setRequestHeader('expires', '0');\n\t    regHttp.setRequestHeader('expires', 'Tue, 01 Jan 1980 1:00:00 GMT');\n\t    regHttp.setRequestHeader('pragma', 'no-cache');\n\t    regHttp.send(); \n\t} else {\n\t    //state.Html.setConsole(\"\");\n\t    state.Html.setFootnote(state,\"Already waiting for reply...\");\n\t    state.Html.setProgress(state, true);\n\t};\n    };\n};\n\nexport default File;\n"]},"metadata":{},"sourceType":"module"}