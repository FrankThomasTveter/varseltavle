{"ast":null,"code":"//console.log(\"Loading DefaultLib.js\");\nfunction Default() {\n  this.setupdir = \"def/\"; // defaults directory\n\n  this.setup = \"defaults.json\"; // defaults file, contains default setup...\n\n  this.path = \"test.json\";\n  this.current = {};\n  this.start = undefined; // setup at start\n  // map: Default => setup\n\n  this.SetupMapFill = [[[\"other\"], [\"other\"]], [[\"trash\"], [\"trash\"]]];\n  this.SetupMapForce = [[[\"Threshold\", \"thrs\"], [\"thrs\"]], [[\"Colors\", \"colors\"], [\"colors\"]], [[\"Path\", \"order\"], [\"order\"]], [[\"Path\", \"select\"], [\"select\"]], [[\"Path\", \"home\"], [\"home\"]], [[\"Path\", \"tooltip\"], [\"tooltip\"]], [[\"Layout\", \"priority\"], [\"priority\"]], [[\"Layout\", \"state\"], [\"state\"]]]; // map: Default => state\n\n  this.StateMapFill = [[[\"Threshold\", \"thrs\"], [\"Threshold\", \"thrs\"]], [[\"Colors\", \"colors\"], [\"Colors\", \"colors\"]], [[\"Path\", \"order\"], [\"Path\", \"order\"]], [[\"Path\", \"home\"], [\"Path\", \"home\"]], [[\"Path\", \"tooltip\", \"keys\"], [\"Path\", \"tooltip\", \"keys\"]], [[\"Path\", \"tooltip\", \"select\"], [\"Path\", \"tooltip\", \"select\"]], [[\"Path\", \"tooltip\", \"sort\"], [\"Path\", \"tooltip\", \"sort\"]], [[\"Path\", \"tooltip\", \"click\"], [\"Path\", \"tooltip\", \"click\"]], [[\"Path\", \"select\"], [\"Path\", \"select\"]], [[\"Layout\", \"priority\"], [\"Layout\", \"priority\"]], [[\"Layout\", \"state\"], [\"Layout\", \"state\"]]];\n\n  this.init = function (state) {\n    var par = \"setup\";\n    state.Utils.init(par, this);\n  };\n\n  this.loadDefault = function (state, callbacks) {\n    var file = this.setup;\n    console.log(\"Default setup:\", file);\n\n    if (state.Threshold.thrs !== undefined) {\n      // defaults already loaded, execute callback...\n      state.File.next(state, \"\", callbacks);\n    } else {\n      var path = state.Default.setupdir + state.Default.setup;\n      state.File.load(state, path, callbacks);\n    }\n  };\n\n  this.makeStart = function (state, response, callbacks) {\n    if (state.Default.start === undefined) {\n      state.Default.start = {};\n      state.Utils.mapFill(state, state.Default.DefaultMapFill, state.Default.start, state); //state.Default.save(state);\n    }\n\n    state.File.next(state, \"\", callbacks);\n  };\n\n  this.processDefault = function (state, response, callbacks) {\n    if (state.Threshold.thrs !== undefined) {\n      // defaults already loaded, execute callback...\n      state.File.next(state, \"\", callbacks);\n    } else {\n      try {\n        var json = JSON.parse(response);\n      } catch (e) {\n        alert(\"Default '\" + state.Default.setup + \"' contains Invalid JSON:\" + e.name + \":\" + e.message);\n      }\n\n      if (json !== undefined) {\n        //console.log(\"state:\",JSON.stringify(state.Path));\n        state.Utils.mapFill(state, state.Default.SetupMapFill, state.Default.current, json);\n        state.Utils.mapForce(state, state.Default.SetupMapForce, state.Default.current, json);\n        state.Utils.mapFill(state, state.Default.StateMapFill, state, state.Default.current); //console.log(\"JSON:\",JSON.stringify(json.tooltip));\n        //console.log(\"Default:\",JSON.stringify(state.Default.Path.tooltip));\n        //console.log(\"State:\",JSON.stringify(state.Path.tooltip));\n      }\n\n      ; // finally execute next callback\n\n      state.File.next(state, \"\", callbacks);\n    }\n  };\n\n  this.resetSetup = function (state, response, callbacks) {\n    try {\n      var json = JSON.parse(response);\n    } catch (e) {\n      alert(\"Default '\" + state.Default.setup + \"' contains Invalid JSON:\" + e.name + \":\" + e.message);\n    }\n\n    if (json !== undefined && state.Default.start !== undefined) {\n      console.log(\"Reset state:\", JSON.stringify(state.Path));\n      state.Default.current = {};\n      state.Utils.mapFill(state, state.Default.SetupMapFill, state.Default.current, json);\n      state.Utils.mapForce(state, state.Default.SetupMapForce, state.Default.current, json);\n      state.Utils.mapFill(state, state.Default.StateMapFill, state.Default.start, state.Default.current);\n      state.Utils.mapForce(state, state.Default.StateMapFill, state, state.Default.current); //console.log(\"JSON:\",JSON.stringify(json.tooltip));\n      //console.log(\"Default:\",JSON.stringify(state.Default.Path.tooltip));\n\n      state.Database.resetSetup(state);\n      console.log(\"Reset State:\", JSON.stringify(state.Path));\n    }\n\n    ;\n  };\n\n  this.getSetup = function (state) {\n    // get updated information\n    var json = {};\n    state.Utils.mapForce(state, state.Utils.invertMap(state.Default.SetupMapForce), json, state.Default.current);\n    state.Utils.mapFill(state, state.Utils.invertMap(state.Default.SetupMapFill), json, state.Default.current); //JSON.stringify(setup, null, \"   \");\n\n    return json;\n  };\n\n  this.save = function (state) {\n    var setup = state.Utils.prettyJson(state.Default.getSetup(state));\n    state.Utils.save(setup, \"setup.json\", \"json\");\n  };\n\n  this.hasChanged = function (state, main, item) {\n    if (state.Default !== undefined && state.Default.start !== undefined && state.Default.start[main] !== undefined && state.Default.start[main][item] !== undefined) {\n      var src = JSON.stringify(state[main][item]);\n      var trg = JSON.stringify(state.Default.start[main][item]);\n      console.log(\"Checking:\", main, item, \"\\n\", src, \"\\n\", trg, \"->\", src !== trg);\n      return src !== trg;\n    } else {\n      return true;\n    }\n  };\n}\n\n;\nexport default Default;","map":{"version":3,"sources":["/home/franktt/react/varseltavle/src/lib/DefaultLib.js"],"names":["Default","setupdir","setup","path","current","start","undefined","SetupMapFill","SetupMapForce","StateMapFill","init","state","par","Utils","loadDefault","callbacks","file","console","log","Threshold","thrs","File","next","load","makeStart","response","mapFill","DefaultMapFill","processDefault","json","JSON","parse","e","alert","name","message","mapForce","resetSetup","stringify","Path","Database","getSetup","invertMap","save","prettyJson","hasChanged","main","item","src","trg"],"mappings":"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","sourcesContent":["//console.log(\"Loading DefaultLib.js\");\nfunction Default() {\n    this.setupdir=\"def/\"; // defaults directory\n    this.setup=\"defaults.json\"; // defaults file, contains default setup...\n    this.path=\"test.json\";\n    this.current={};\n    this.start=undefined; // setup at start\n    // map: Default => setup\n    this.SetupMapFill= [[[\"other\"],                  [\"other\"]],\n\t\t\t[[\"trash\"],                  [\"trash\"]]\n\t\t       ];\n    this.SetupMapForce=[[[\"Threshold\",\"thrs\"],       [\"thrs\"]],\n\t\t\t[[\"Colors\",\"colors\"],        [\"colors\"]],\n\t\t\t[[\"Path\",\"order\"],           [\"order\"]],\n\t\t\t[[\"Path\",\"select\"],          [\"select\"]],\n\t\t\t[[\"Path\",\"home\"],            [\"home\"]],\n\t\t\t[[\"Path\",\"tooltip\"],         [\"tooltip\"]],\n\t\t\t[[\"Layout\",\"priority\"],      [\"priority\"]],\n\t\t\t[[\"Layout\",\"state\"],         [\"state\"]]\n\t\t       ];\n    // map: Default => state\n    this.StateMapFill= [[[\"Threshold\",\"thrs\"],       [\"Threshold\",\"thrs\"]],\n\t\t\t[[\"Colors\",\"colors\"],        [\"Colors\",\"colors\"]],\n\t\t\t[[\"Path\",\"order\"],           [\"Path\",\"order\"]],\n\t\t\t[[\"Path\",\"home\"],            [\"Path\",\"home\"]],\n\t\t\t[[\"Path\",\"tooltip\",\"keys\"],  [\"Path\",\"tooltip\",\"keys\"]],\n\t\t\t[[\"Path\",\"tooltip\",\"select\"],[\"Path\",\"tooltip\",\"select\"]],\n\t\t\t[[\"Path\",\"tooltip\",\"sort\"],  [\"Path\",\"tooltip\",\"sort\"]],\n\t\t\t[[\"Path\",\"tooltip\",\"click\"], [\"Path\",\"tooltip\",\"click\"]],\n\t\t\t[[\"Path\",\"select\"],          [\"Path\",\"select\"]],\n\t\t\t[[\"Layout\",\"priority\"],      [\"Layout\",\"priority\"]],\n\t\t\t[[\"Layout\",\"state\"],         [\"Layout\",\"state\"]]\n\t\t       ];\n    this.init=function(state){\n\tvar par=\"setup\";\n\tstate.Utils.init(par,this);\n    };\n    this.loadDefault=function(state, callbacks ) {\n\tvar file=this.setup;\n\tconsole.log(\"Default setup:\",file);\n\tif (state.Threshold.thrs !== undefined) { // defaults already loaded, execute callback...\n\t    state.File.next(state,\"\",callbacks);\n\t} else {\n\t    var path=state.Default.setupdir + state.Default.setup;\n\t    state.File.load(state,path,callbacks);\n\t}\n    };\n    this.makeStart=function(state,response,callbacks) {\n\tif (state.Default.start === undefined) {\n\t    state.Default.start={};\n\t    state.Utils.mapFill(state, state.Default.DefaultMapFill, state.Default.start, state);\n\t    //state.Default.save(state);\n\t}\n\tstate.File.next(state,\"\",callbacks);\n    };\n    this.processDefault=function(state,response,callbacks) {\n\tif (state.Threshold.thrs !== undefined) { // defaults already loaded, execute callback...\n\t    state.File.next(state,\"\",callbacks);\n\t} else {\n\t    try {\n\t\tvar json = JSON.parse(response);\n\t    } catch (e) {\n\t\talert(\"Default '\"+state.Default.setup+\"' contains Invalid JSON:\"+e.name+\":\"+e.message);\n\t    }\n\t    if (json !== undefined) {\n\t\t//console.log(\"state:\",JSON.stringify(state.Path));\n\t\t\n\t\tstate.Utils.mapFill(state, state.Default.SetupMapFill, state.Default.current, json);\n\t\tstate.Utils.mapForce(state,state.Default.SetupMapForce,state.Default.current, json);\n\t\tstate.Utils.mapFill(state, state.Default.StateMapFill, state,                 state.Default.current);\n\t\t\n\t\t//console.log(\"JSON:\",JSON.stringify(json.tooltip));\n\t\t//console.log(\"Default:\",JSON.stringify(state.Default.Path.tooltip));\n\t\t//console.log(\"State:\",JSON.stringify(state.Path.tooltip));\n\t\t\n\t    };\n\t    // finally execute next callback\n\t    state.File.next(state,\"\",callbacks);\n\t}\n    };\n    this.resetSetup=function(state,response,callbacks) {\n\ttry {\n\t    var json = JSON.parse(response);\n\t} catch (e) {\n\t    alert(\"Default '\"+state.Default.setup+\"' contains Invalid JSON:\"+e.name+\":\"+e.message);\n\t}\n\tif (json !== undefined && state.Default.start !== undefined) {\n\t    console.log(\"Reset state:\",JSON.stringify(state.Path));\n\t    state.Default.current={};\n\t    state.Utils.mapFill(state, state.Default.SetupMapFill,   state.Default.current, json);\n\t    state.Utils.mapForce(state,state.Default.SetupMapForce,  state.Default.current, json);\n\t    state.Utils.mapFill(state, state.Default.StateMapFill,   state.Default.start,   state.Default.current);\n\t    state.Utils.mapForce(state,state.Default.StateMapFill,   state,                 state.Default.current);\n\t    //console.log(\"JSON:\",JSON.stringify(json.tooltip));\n\t    //console.log(\"Default:\",JSON.stringify(state.Default.Path.tooltip));\n\t    state.Database.resetSetup(state);\n\t    console.log(\"Reset State:\",JSON.stringify(state.Path));\n\t};\n    };\n    this.getSetup=function(state) {\n\t// get updated information\n\tvar json={};\n\tstate.Utils.mapForce(state, state.Utils.invertMap(state.Default.SetupMapForce), json, state.Default.current);\n\tstate.Utils.mapFill(state, state.Utils.invertMap(state.Default.SetupMapFill), json, state.Default.current);\n\t//JSON.stringify(setup, null, \"   \");\n\treturn json;\n    };\n    this.save=function(state) {\n\tvar setup=state.Utils.prettyJson(state.Default.getSetup(state));\n\tstate.Utils.save(setup,\"setup.json\",\"json\");\n    };\n    this.hasChanged=function(state,main,item) {\n\tif (state.Default!==undefined && \n\t    state.Default.start!==undefined && \n\t    state.Default.start[main]!==undefined &&\n\t    state.Default.start[main][item]!==undefined) {\n\t    var src=JSON.stringify(state[main][item]);\n\t    var trg=JSON.stringify(state.Default.start[main][item]);\n\t    console.log(\"Checking:\",main,item,\"\\n\",src,\"\\n\",trg,\"->\",src!==trg);\n\t    return src!==trg;\n\t} else {\n\t    return true;\n\t}\n    };\n};\nexport default Default;\n"]},"metadata":{},"sourceType":"module"}