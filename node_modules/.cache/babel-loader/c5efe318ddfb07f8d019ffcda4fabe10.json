{"ast":null,"code":"//console.log(\"Loading Map2DLib.js\");\nfunction Map2D() {\n  this.Show = function (state, matrix, item, skeys, colkey, colvalues, rowkey, rowvalues, cellMode) {\n    // make header row\n    var row = document.createElement(\"TR\"); //console.log(\"Col=\",colkey,\" row=\",rowkey);\n\n    console.log(\"Making rows:\", rowkey, JSON.stringify(rowvalues));\n    this.appendHeaderRow2D(state, matrix, row, colkey, colvalues, rowkey);\n    item.appendChild(row); // make data rows\n\n    var rlen = rowvalues.length;\n\n    for (var ii = 0; ii < rlen; ii++) {\n      var rel = ii === 0 ? \"first\" : (state, ii === rlen - 1 ? \"last\" : \"middle\"); //console.log(\"Making data row:\",ii,rowkey,rowvalues[ii])\n      // make \"header\" column\n\n      row = document.createElement(\"TR\");\n      this.appendDataRow2D(state, matrix, row, colkey, colvalues, rowkey, rowvalues, ii, rel, cellMode);\n      item.appendChild(row);\n    }\n  };\n\n  this.appendHeaderRow2D = function (state, matrix, row, colkey, colvalues, rowkey) {\n    state.Html.appendRotateElement(state, row, \"lat\", \"lon\"); // add rotation-element\n\n    var clen = colvalues.length;\n\n    for (var ii = 0; ii < clen; ii++) {\n      var rel = ii === 0 ? \"first\" : (state, ii === clen - 1 ? \"last\" : \"middle\");\n      var rotate = (state.Layout.rotate || {})[colkey] || \"\";\n      var colval = colvalues[ii];\n      var colwhere = state.Matrix.getLonWhere(state, \"lon\", colvalues, ii); //console.log(\"---header:\",ii,colkey,colval,clen)\n      // make \"header\" column\n\n      row.appendChild(state.Html.makeHeaderElement(state, colkey, // pkey\n      colval || \"\", // pval\n      rel, // prel\n      \"Col\", // ptyp\n      \"state.Layout.selectKey(state,'lon','\" + (colval || \"\") + \"','\" + colwhere + \"','2');\", \"Select '\" + colwhere + \"'\", rotate));\n    }\n  };\n\n  this.appendDataRow2D = function (state, matrix, row, colkey, colvalues, rowkey, rowvalues, kk, rel, cellMode) {\n    var rowval = rowvalues[kk];\n    var rowwhere = state.Matrix.getLatWhere(state, \"lat\", rowvalues, kk);\n\n    if (rowkey === \"\") {\n      state.Html.appendEmptyHeader(state, row); // add empty element\n    } else {\n      row.appendChild(state.Html.makeHeaderElement(state, rowkey, // pkey\n      rowval || \"\", // pval\n      rel, // prel\n      \"row\", // ptyp\n      \"state.Layout.selectKey(state,'lat','\" + (rowval || \"\") + \"','\" + rowwhere + \"','2');\", \"Select '\" + rowwhere + \"'\", \"\" // never rotate\n      ));\n    }\n\n    ;\n    var range = state.Matrix.getRange(state, matrix, colvalues, [rowval]);\n    var clen = colvalues.length;\n\n    for (var jj = 0; jj < clen; jj++) {\n      var colwhere = state.Matrix.getLonWhere(state, \"lon\", colvalues, jj);\n      var element = state.Matrix.getMatrixElement(colvalues[jj], rowval, matrix);\n\n      if (element === undefined) {\n        //console.log(\"---Missing element=\",jj,kk,colvalues[jj],rowval);\n        state.Html.appendEmptyData(state, row); // add empty element\n      } else {\n        //console.log(\"---Item:\",jj,rowkey,rowval,colkey,colvalues[jj])\n        var step = 1;\n\n        if (cellMode === state.Show.code.mSum) {\n          row.appendChild(state.Html.makeDataElement(state, [element], \"state.Layout.selectItem(state,'\" + colkey + \"','\" + rowkey + \"','\" + colvalues[jj] + \"','\" + rowval + \"','\" + colwhere + \"','\" + rowwhere + \"','2','2');\", \"(state,\" + colwhere + \") AND (\" + rowwhere + \")\", step));\n        } else {\n          row.appendChild(state.Html.makeCanvasElement(state, [element], colkey, [colvalues[jj]], range, \"state.Layout.selectItem(state,'lon','lat','\" + colvalues[jj] + \"','\" + rowval + \"','\" + colwhere + \"','\" + rowwhere + \"','2','2');\", \"Select '\" + colwhere + \"' and '\" + rowwhere + \"'\", step));\n        }\n\n        ;\n      }\n\n      ;\n    }\n  };\n}\n\n;\nexport default Map2D;","map":{"version":3,"sources":["/home/franktt/react/varseltavle/src/lib/Map2DLib.js"],"names":["Map2D","Show","state","matrix","item","skeys","colkey","colvalues","rowkey","rowvalues","cellMode","row","document","createElement","console","log","JSON","stringify","appendHeaderRow2D","appendChild","rlen","length","ii","rel","appendDataRow2D","Html","appendRotateElement","clen","rotate","Layout","colval","colwhere","Matrix","getLonWhere","makeHeaderElement","kk","rowval","rowwhere","getLatWhere","appendEmptyHeader","range","getRange","jj","element","getMatrixElement","undefined","appendEmptyData","step","code","mSum","makeDataElement","makeCanvasElement"],"mappings":"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","sourcesContent":["//console.log(\"Loading Map2DLib.js\");\n\nfunction Map2D() {\n    this.Show=function(state,matrix,item,skeys,colkey,colvalues,rowkey,rowvalues,cellMode){\n\t// make header row\n\tvar row = document.createElement(\"TR\");\n\t//console.log(\"Col=\",colkey,\" row=\",rowkey);\n\tconsole.log(\"Making rows:\",rowkey,JSON.stringify(rowvalues))\n\tthis.appendHeaderRow2D(state,matrix,row,colkey,colvalues,rowkey);\n\titem.appendChild(row);\n\t// make data rows\n\tvar rlen=rowvalues.length;\n\tfor(var ii=0; ii<rlen; ii++) {\n\t    var rel = (ii  === 0?\"first\":(state,ii  === rlen-1?\"last\":\"middle\"));\n\t    //console.log(\"Making data row:\",ii,rowkey,rowvalues[ii])\n\t    // make \"header\" column\n\t    row = document.createElement(\"TR\");\n\t    this.appendDataRow2D(state,matrix,row,colkey,colvalues,rowkey,rowvalues,ii,rel,cellMode);\n\t    item.appendChild(row);\n\t}\n    };\n    this.appendHeaderRow2D=function(state,matrix,row,colkey,colvalues,rowkey) {\n\tstate.Html.appendRotateElement(state,row,\"lat\",\"lon\"); // add rotation-element\n\tvar clen=colvalues.length;\n\tfor(var ii=0; ii<clen; ii++) {\n\t    var rel = (ii  === 0?\"first\":(state,ii  === clen-1?\"last\":\"middle\"));\n\t    var rotate=(state.Layout.rotate||{})[colkey]||\"\";\n\t    var colval = colvalues[ii];\n\t    var colwhere = state.Matrix.getLonWhere(state,\"lon\",colvalues,ii);\n\t    //console.log(\"---header:\",ii,colkey,colval,clen)\n\t    // make \"header\" column\n\t    row.appendChild(\n\t\tstate.Html.makeHeaderElement(state,\n\t\t    colkey,         // pkey\n\t\t    colval||\"\",         // pval\n\t\t    rel,          // prel\n\t\t    \"Col\",        // ptyp\n\t\t    \"state.Layout.selectKey(state,'lon','\"+(colval||\"\")+\"','\"+colwhere+\"','2');\",\n\t\t    \"Select '\"+colwhere+\"'\",\n\t\t    rotate\n\t\t)\n\t    );\n\t}\n    };\n    this.appendDataRow2D=function(state,matrix,row,colkey,colvalues,rowkey,rowvalues,kk,rel,cellMode) {\n\tvar rowval=rowvalues[kk]\n\tvar rowwhere = state.Matrix.getLatWhere(state,\"lat\",rowvalues,kk);\n\tif (rowkey  === \"\") {\n\t    state.Html.appendEmptyHeader(state,row);// add empty element\n\t} else {\n\t    row.appendChild(\n\t\tstate.Html.makeHeaderElement(state,\n\t\t    rowkey,         // pkey\n\t\t    rowval||\"\",     // pval\n\t\t    rel,          // prel\n\t\t    \"row\",        // ptyp\n\t\t    \"state.Layout.selectKey(state,'lat','\"+(rowval||\"\")+\"','\"+rowwhere+\"','2');\",\n\t\t    \"Select '\"+rowwhere+\"'\",\n\t\t    \"\" // never rotate\n\t\t));\n\t};\n\tvar range=state.Matrix.getRange(state,matrix,colvalues,[rowval]);\n\tvar clen=colvalues.length;\n\tfor(var jj=0; jj<clen; jj++) {\n\t    var colwhere = state.Matrix.getLonWhere(state,\"lon\",colvalues,jj);\n\t    var element=state.Matrix.getMatrixElement(colvalues[jj],rowval,matrix);\n\t    if (element  === undefined) {\n\t\t//console.log(\"---Missing element=\",jj,kk,colvalues[jj],rowval);\n\t\tstate.Html.appendEmptyData(state,row);// add empty element\n\t    } else {\n\t\t//console.log(\"---Item:\",jj,rowkey,rowval,colkey,colvalues[jj])\n\t\tvar step=1;\n\t\tif (cellMode  === state.Show.code.mSum) {\n\t\t    row.appendChild(\n\t\t\tstate.Html.makeDataElement(state,\n\t\t\t    [element],\n\t\t\t    \"state.Layout.selectItem(state,'\"+colkey+\"','\"+rowkey+\"','\"+colvalues[jj]+\"','\"+rowval+\"','\"+\n\t\t\t\tcolwhere+\"','\"+rowwhere+\"','2','2');\",\n\t\t\t    \"(state,\"+colwhere+\") AND (\"+rowwhere+\")\",step)\n\t\t    );\n\t\t} else {\n\t\t    row.appendChild(\n\t\t\tstate.Html.makeCanvasElement(state,\n\t\t\t    [element],\n\t\t\t    colkey,\n\t\t\t    [colvalues[jj]],\n\t\t\t    range,\n\t\t\t    \"state.Layout.selectItem(state,'lon','lat','\"+\n\t\t\t\tcolvalues[jj]+\"','\"+rowval+\"','\"+\n\t\t\t\tcolwhere+\"','\"+rowwhere+\"','2','2');\",\n\t\t\t    \"Select '\"+colwhere+\"' and '\"+rowwhere+\"'\",step)\n\t\t    );\n\t\t};\n\n\n\t    };\n\t}\n    }\n};\nexport default Map2D;\n"]},"metadata":{},"sourceType":"module"}