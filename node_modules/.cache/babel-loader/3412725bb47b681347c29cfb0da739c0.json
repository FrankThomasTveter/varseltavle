{"ast":null,"code":"//console.log(\"Loading ThresholdLib.js\");\nfunction Threshold() {\n  this.thr = undefined; // threshold parameter levels\n\n  this.gthr = undefined; // temporary storage\n\n  this.imax = 0; // threshold item types\n\n  this.ithr = 1;\n  this.ikey = 2;\n  this.ilev = 3;\n  this.ival = 4;\n\n  this.init = function (state) {\n    var par = \"Threshold\";\n    state.Utils.init(par, this);\n  };\n\n  this.getThresholds = function (doc) {\n    if (doc.thresholds !== undefined) {\n      return doc.thresholds;\n    } else {\n      var subthr = {};\n\n      for (var thr in this.thrs) {\n        // loop over thresholds\n        if (doc[thr] !== undefined) {\n          var key = doc[thr]; // key-value\n\n          if (this.thrs[thr][key] !== undefined) {\n            var tlen, dlev, jj, res;\n\n            if (this.thrs[thr][key].max !== undefined && doc.max !== undefined) {\n              var dmax = Number(doc.max);\n              dlev = -1;\n              var tmax = this.thrs[thr][key].max;\n              tlen = tmax.length; // get new level\n\n              for (jj = 0; jj < tlen; jj++) {\n                if (dmax >= Number(tmax[jj])) {\n                  //console.log(\"Hit:\",jj,dmax,tmax[jj],dmax>=tmax[jj],dlev);\n                  dlev = jj;\n                }\n              }\n\n              res = [];\n              res[this.imax] = true;\n              res[this.ithr] = thr;\n              res[this.ikey] = key;\n              res[this.ilev] = dlev;\n              res[this.ival] = dmax;\n              subthr.max = res;\n            } else if (this.thrs[thr][key].min !== undefined && doc.min !== undefined) {\n              // min value\n              dlev = -1;\n              var tmin = this.thrs[thr][key].min;\n              var dmin = Number(doc.min); // get new level\n\n              tlen = tmin.length;\n\n              for (jj = 0; jj < tlen; jj++) {\n                if (dmin <= Number(tmin[jj])) {\n                  dlev = jj;\n                }\n              }\n\n              res = [];\n              res[this.imax] = false;\n              res[this.ithr] = thr;\n              res[this.ikey] = key;\n              res[this.ilev] = dlev;\n              res[this.ival] = dmin;\n              subthr.min = res;\n            } //if (dlev !== -1) {\n            //    console.log(\"Found level:\",dlev,dmax,\n            //    \t\tJSON.stringify(tmax),thr,key);\n            //} else {\n            //    console.log(\"Mssing level:\",dlev,dmax,\n            //    \t\tJSON.stringify(tmax),thr,key);\n            //}\n\n          }\n        }\n      }\n\n      doc.thresholds = subthr;\n      return subthr;\n    }\n  };\n\n  this.setGThr = function (state, doc) {\n    if (this.gthr === undefined || doc[this.gthr[0]] === undefined || doc[this.gthr[0]] !== this.gthr[1]) {\n      this.gthr = this.getThreshold(state, doc);\n    }\n\n    ;\n  }; // call after this.setGThr\n\n\n  this.getLevel = function (state, doc) {\n    var lev = -1;\n\n    if (this.gthr === undefined) {\n      lev = -2;\n    } else if (this.gthr[2].max !== undefined) {\n      lev = this.getThrLevel(state, doc, this.gthr[2], \"max\");\n    } else if (this.gthr[2].min !== undefined) {\n      lev = this.getThrLevel(state, doc, this.gthr[2], \"min\");\n    }\n\n    ;\n    return lev;\n  }; // call after this.setGThr\n\n\n  this.getKeyLat = function (state) {\n    return this.gthr[2][\"latlon\"][0];\n  }; // call after this.setGThr\n\n\n  this.getKeyLon = function (state) {\n    return this.gthr[2][\"latlon\"][1];\n  }; // call after this.setGThr\n\n\n  this.getLat = function (state, doc) {\n    if (this.gthr === undefined) {\n      return undefined;\n    } else if (this.gthr[2][\"latlon\"] !== undefined) {\n      return doc[this.getKeyLat(state)];\n    }\n\n    ;\n  }; // call after this.setGThr\n\n\n  this.getLon = function (state, doc) {\n    if (this.gthr === undefined) {\n      return undefined;\n    } else if (this.gthr[2][\"latlon\"] !== undefined) {\n      return doc[this.getKeyLon(state)];\n    }\n\n    ;\n  };\n\n  this.getThreshold = function (state, doc) {\n    if (doc.threshold !== undefined) {\n      return doc.threshold;\n    } else {\n      for (var thr in this.thrs) {\n        // loop over thresholds\n        if (doc[thr] !== undefined) {\n          var key = doc[thr]; // key-value\n\n          if (this.thrs[thr][key] !== undefined) {\n            var threshold = [thr, key, this.thrs[thr][key]];\n            doc.threshold = threshold;\n            return threshold;\n          }\n        }\n      }\n\n      return;\n    }\n  };\n\n  this.getThrLevel = function (state, doc, thrs, key) {\n    var tlen, jj;\n    var lev = -1;\n    var val = doc[key];\n    var thr = thrs[key];\n\n    if (key === \"max\") {\n      tlen = thr.length;\n\n      for (jj = 0; jj < tlen; jj++) {\n        if (val >= Number(thr[jj])) {\n          //console.log(\"Hit:\",jj,val,thr[jj]);\n          lev = jj;\n        }\n      }\n    } else if (key === \"min\") {\n      tlen = thr.length;\n\n      for (jj = 0; jj < tlen; jj++) {\n        if (val <= Number(thr[jj])) {\n          //console.log(\"Hit:\",jj,val,thr[jj]);\n          lev = jj;\n        }\n      }\n    }\n\n    return lev;\n  };\n}\n\n;\nexport default Threshold;","map":{"version":3,"sources":["/home/franktt/react/varseltavle/src/lib/ThresholdLib.js"],"names":["Threshold","thr","undefined","gthr","imax","ithr","ikey","ilev","ival","init","state","par","Utils","getThresholds","doc","thresholds","subthr","thrs","key","tlen","dlev","jj","res","max","dmax","Number","tmax","length","min","tmin","dmin","setGThr","getThreshold","getLevel","lev","getThrLevel","getKeyLat","getKeyLon","getLat","getLon","threshold","val"],"mappings":"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","sourcesContent":["//console.log(\"Loading ThresholdLib.js\");\n\nfunction Threshold() {\n    this.thr=undefined; // threshold parameter levels\n    this.gthr=undefined;// temporary storage\n    this.imax=0;        // threshold item types\n    this.ithr=1;\n    this.ikey=2;\n    this.ilev=3;\n    this.ival=4;\n    this.init=function(state){\n\tvar par=\"Threshold\";\n\tstate.Utils.init(par,this);\n    };\n    this.getThresholds=function(doc) {\n\tif (doc.thresholds !== undefined) {\n\t    return doc.thresholds;\n\t} else {\n\t    var subthr={};\n\t    for (var thr in this.thrs) { // loop over thresholds\n\t\tif (doc[thr] !== undefined) {\n\t\t    var key=doc[thr]; // key-value\n\t\t    if (this.thrs[thr][key] !== undefined) {\n\t\t\tvar tlen,dlev,jj,res;\n\t\t\tif (this.thrs[thr][key].max !== undefined &&\n\t\t\t    doc.max !== undefined) {\n\t\t\t    var dmax=Number(doc.max);\n\t\t\t    dlev=-1;\n\t\t\t    var tmax=this.thrs[thr][key].max;\n\t\t\t    tlen=tmax.length;\n\t\t\t    // get new level\n\t\t\t    for (jj = 0; jj < tlen; jj++) {\n\t\t\t\tif (dmax >= Number(tmax[jj])) {\n\t\t\t\t    //console.log(\"Hit:\",jj,dmax,tmax[jj],dmax>=tmax[jj],dlev);\n\t\t\t\t    dlev=jj;\n\t\t\t\t}\n\t\t\t    }\n\t\t\t    res=[];\n\t\t\t    res[this.imax]=true;\n\t\t\t    res[this.ithr]=thr;\n\t\t\t    res[this.ikey]=key;\n\t\t\t    res[this.ilev]=dlev;\n\t\t\t    res[this.ival]=dmax;\n\t\t\t    subthr.max=res;\n\t\t\t} else if (this.thrs[thr][key].min !== undefined && doc.min !== undefined) { // min value\n\t\t\t    dlev=-1;\n\t\t\t    var tmin=this.thrs[thr][key].min;\n\t\t\t    var dmin=Number(doc.min);\n\t\t\t    // get new level\n\t\t\t    tlen=tmin.length;\n\t\t\t    for (jj = 0; jj < tlen; jj++) {\n\t\t\t\tif (dmin <= Number(tmin[jj])) {\n\t\t\t\t    dlev=jj;\n\t\t\t\t}\n\t\t\t    }\n\t\t\t    res=[];\n\t\t\t    res[this.imax]=false;\n\t\t\t    res[this.ithr]=thr;\n\t\t\t    res[this.ikey]=key;\n\t\t\t    res[this.ilev]=dlev;\n\t\t\t    res[this.ival]=dmin;\n\t\t\t    subthr.min=res;\n\t\t\t}\n\t\t\t//if (dlev !== -1) {\n\t\t\t//    console.log(\"Found level:\",dlev,dmax,\n\t\t\t//    \t\tJSON.stringify(tmax),thr,key);\n\t\t\t//} else {\n\t\t\t//    console.log(\"Mssing level:\",dlev,dmax,\n\t\t\t//    \t\tJSON.stringify(tmax),thr,key);\n\t\t\t//}\n\t\t    }\n\t\t}\n\t    }\n\t    doc.thresholds=subthr;\n\t    return subthr;\n\t}\n    };\n    this.setGThr=function(state,doc) {\n\tif (this.gthr  === undefined ||\n\t    doc[this.gthr[0]]  === undefined ||\n\t    doc[this.gthr[0]] !== this.gthr[1]) {\n\t    this.gthr=this.getThreshold(state,doc);\n\t};\n    }\n\n    // call after this.setGThr\n    this.getLevel=function(state,doc) {\n\tvar lev=-1;\n\tif (this.gthr  === undefined) {\n\t    lev=-2;\n\t} else if (this.gthr[2].max !== undefined) {\n\t    lev=this.getThrLevel(state,doc,this.gthr[2],\"max\");\n\t} else if (this.gthr[2].min !== undefined) {\n\t    lev=this.getThrLevel(state,doc,this.gthr[2],\"min\");\n\t};\n\treturn lev;\n    }\n\n    // call after this.setGThr\n    this.getKeyLat=function(state) {\n\treturn this.gthr[2][\"latlon\"][0];\n    }\n\n    // call after this.setGThr\n    this.getKeyLon=function(state) {\n\treturn this.gthr[2][\"latlon\"][1];\n    }\n\n    // call after this.setGThr\n    this.getLat=function(state,doc) {\n\tif (this.gthr  === undefined) {\n\t    return undefined;\n\t} else if (this.gthr[2][\"latlon\"] !== undefined) {\n\t    return doc[this.getKeyLat(state)];\n\t};\n    }\n\n    // call after this.setGThr\n    this.getLon=function(state,doc) {\n\tif (this.gthr  === undefined) {\n\t    return undefined;\n\t} else if (this.gthr[2][\"latlon\"] !== undefined) {\n\t    return doc[this.getKeyLon(state)];\n\t};\n    };\n    this.getThreshold=function(state,doc) {\n\tif (doc.threshold !== undefined) {\n\t    return doc.threshold;\n\t} else {\n\t    for (var thr in this.thrs) { // loop over thresholds\n\t\tif (doc[thr] !== undefined) {\n\t\t    var key=doc[thr]; // key-value\n\t\t    if (this.thrs[thr][key] !== undefined) {\n\t\t\tvar threshold= [thr,key,this.thrs[thr][key]];\n\t\t\tdoc.threshold=threshold;\n\t\t\treturn threshold;\n\t\t    }\n\t\t}\n\t    }\n\t    return;\n\t}\n    };\n    this.getThrLevel=function(state,doc,thrs,key) {\n\tvar tlen,jj;\n\tvar lev=-1;\n\tvar val=doc[key];\n\tvar thr=thrs[key];\n\tif (key  === \"max\") {\n\t    tlen=thr.length;\n\t    for (jj = 0; jj < tlen; jj++) {\n\t\tif (val >= Number(thr[jj])) {\n\t\t    //console.log(\"Hit:\",jj,val,thr[jj]);\n\t\t    lev=jj;\n\t\t}\n\t    }\n\t} else if (key  === \"min\") {\n\t    tlen=thr.length;\n\t    for (jj = 0; jj < tlen; jj++) {\n\t\tif (val <= Number(thr[jj])) {\n\t\t    //console.log(\"Hit:\",jj,val,thr[jj]);\n\t\t    lev=jj;\n\t\t}\n\t    }\n\t}\n\treturn lev;\n    }\n};\nexport default Threshold;\n"]},"metadata":{},"sourceType":"module"}