{"ast":null,"code":"//console.log(\"Loading ShowLib.js\");\nfunction Show() {\n  this.init = function (state) {\n    var par = \"Show\";\n    state.Utils.init(par, this);\n  };\n\n  this.showMode = function (state) {\n    // show data on screen\n    if (state.React.Mode !== undefined) {\n      state.React.Mode.show(state);\n    }\n  };\n\n  this.show = function (state, reload, callbacks) {\n    setTimeout(function () {\n      this.showAll(state, reload);\n\n      if (callbacks !== undefined) {\n        var callback = callbacks.shift();\n\n        if (callback !== undefined) {\n          callback(state, callbacks);\n        }\n      }\n\n      ;\n    }.bind(this), 0.1);\n  };\n\n  this.showAll = function (state, reload) {\n    // show data on screen\n    //var documentLog = document.getElementById(\"log\");\n    //console.log(\"Showing data.\");\n    if (reload === undefined || reload) {\n      this.showPath(state);\n      state.Html.setFootnote(state, \"Extracting data.\");\n      state.Html.setProgress(state, true);\n      setTimeout(function () {\n        state.Database.dbextract(state, function (state, matrix) {\n          state.Html.setFootnote(state, \"Displaying data.\");\n          setTimeout(function () {\n            // callback\n            //console.log(\"Updating matrix.\");\n            state.Path.exportAllKeys(state); //console.log(\"Showing path\");\n\n            this.showPath(state); //console.log(\"Showing Config\");\n\n            this.showConfig(state); //console.log(\"Showing matrix\");\n\n            sleep(3);\n            this.showTable(state, matrix); //console.log(\"Pushing URL\");\n\n            state.Utils.pushUrl(state);\n            state.Html.setFootnote(state);\n            state.Html.setProgress(state, false);\n            console.log(\"Delayed showAll is done...\");\n          }.bind(this), 0.1);\n        }.bind(this));\n      }.bind(this), 0.1);\n    } else {\n      console.log(\"Not updating matrix.\");\n      state.Path.exportAllKeys(state);\n      this.showPath(state);\n      this.showConfig(state);\n      this.showTable(state);\n      this.showTooltip(state);\n      state.Html.setFootnote(state);\n      state.Html.setProgress(state, false);\n    }\n\n    this.showMode(state);\n  };\n\n  this.showPath = function (state) {\n    if (state.React.Path !== undefined) {\n      state.React.Path.showPath(state); // forceUpdate()\n    } else {\n      console.log(\"No react-path available.\");\n    }\n\n    if (state.React.Location !== undefined) {\n      state.React.Location.showLocation(state); // forceUpdate()\n    } else {\n      console.log(\"No react-location available.\");\n    }\n\n    if (state.React.LevelBar !== undefined) {\n      state.React.LevelBar.showLevelBar(state); // forceUpdate()\n    } else {\n      console.log(\"No react-disclaimer available.\");\n    }\n  };\n\n  this.showConfig = function (state) {\n    if (state.React.Config !== undefined) {\n      state.React.Config.show(state); // forceUpdate()\n    } else {\n      console.log(\"No react-config available.\");\n    }\n  };\n\n  this.showMatrix = function (state, matrix) {\n    if (state.React.Dataset !== undefined) {\n      state.React.Dataset.showMatrix(state, matrix);\n    }\n  };\n\n  this.showTable = function (state, matrix) {\n    console.log(\"Showing table...\");\n\n    if (matrix !== undefined) {\n      //console.log(\"Defining matrix...\");\n      state.React.matrix = matrix;\n    }\n\n    ; //console.log(\"ShowTable:\",state.Layout.state.layoutMode,state.Layout.modes.layout.Map);\n\n    if (state.Layout.state.layoutMode === state.Layout.modes.layout.Map) {\n      if (state.React.Map !== undefined) {\n        state.React.Map.showMap(state);\n      }\n    } else {\n      if (state.React.Table !== undefined) {\n        state.React.Table.showTable(state);\n      }\n    }\n\n    console.log(\"Showing table done...\");\n  };\n\n  this.showTooltip = function (state) {\n    if (state.React.Tooltip !== undefined) {\n      state.React.Tooltip.rebuild();\n    }\n  };\n\n  this.useCanvas = function (state, matrix) {\n    // check if matrix elements have max 1 data\n    // loop over matrix\n    for (var ii in matrix) {\n      for (var jj in matrix[ii]) {\n        if (matrix[ii][jj].cnt > 1) {\n          return false;\n        }\n      }\n    }\n\n    return true;\n  };\n\n  this.scale = function (xval, xmin, xmax, ymin, ymax) {\n    if (ymin > ymax) {\n      return ymin + (xval - xmin) * (ymax - ymin) / (xmax - xmin);\n    } else {\n      return (xval - xmin) * (ymax - ymin) / (xmax - xmin);\n    }\n  };\n}\n\n;\nexport default Show;","map":{"version":3,"sources":["/home/franktt/react/varseltavle/src/lib/ShowLib.js"],"names":["Show","init","state","par","Utils","showMode","React","Mode","undefined","show","reload","callbacks","setTimeout","showAll","callback","shift","bind","showPath","Html","setFootnote","setProgress","Database","dbextract","matrix","Path","exportAllKeys","showConfig","sleep","showTable","pushUrl","console","log","showTooltip","Location","showLocation","LevelBar","showLevelBar","Config","showMatrix","Dataset","Layout","layoutMode","modes","layout","Map","showMap","Table","Tooltip","rebuild","useCanvas","ii","jj","cnt","scale","xval","xmin","xmax","ymin","ymax"],"mappings":"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","sourcesContent":["//console.log(\"Loading ShowLib.js\");\n\nfunction Show() {\n    this.init=function(state){\n\tvar par=\"Show\";\n\tstate.Utils.init(par,this);\n    };\n    this.showMode=function(state) { // show data on screen\n\tif (state.React.Mode !== undefined) {\n\t    state.React.Mode.show(state);\n\t}\n    };\n    this.show=function(state,reload,callbacks) {\n        setTimeout(function() {\n\t    this.showAll(state,reload);\n\t    if (callbacks !== undefined) {\n\t\tvar callback=callbacks.shift();\n\t\tif (callback !== undefined) {\n\t\t    callback(state,callbacks)\n\t\t}\n\t    };\n\t}.bind(this),0.1);\n    };\n    this.showAll=function(state,reload) { // show data on screen\n\t//var documentLog = document.getElementById(\"log\");\n\t//console.log(\"Showing data.\");\n\tif (reload  === undefined || reload) {\n\t    this.showPath(state);\n\t    state.Html.setFootnote(state,\"Extracting data.\");\n\t    state.Html.setProgress(state, true);\n\t    setTimeout(function() {\n\t\tstate.Database.dbextract(state,function (state,matrix){\n\t\t    state.Html.setFootnote(state,\"Displaying data.\");\n\t\t    setTimeout(function (){  // callback\n\t\t\t//console.log(\"Updating matrix.\");\n\t\t\tstate.Path.exportAllKeys(state);\n\t\t\t//console.log(\"Showing path\");\n\t\t\tthis.showPath(state);\n\t\t\t//console.log(\"Showing Config\");\n\t\t\tthis.showConfig(state);\n\t\t\t//console.log(\"Showing matrix\");\n\t\t\tsleep(3);\n\t\t\tthis.showTable(state,matrix);\n\t\t\t//console.log(\"Pushing URL\");\n\t\t\tstate.Utils.pushUrl(state);\n\t\t\tstate.Html.setFootnote(state);\n\t\t\tstate.Html.setProgress(state, false);\n\t\t\tconsole.log(\"Delayed showAll is done...\");\n\t\t    }.bind(this),0.1);\n\t\t}.bind(this));\n\t    }.bind(this),0.1);\n\t} else {\n\t    console.log(\"Not updating matrix.\");\n\t    state.Path.exportAllKeys(state);\n\t    this.showPath(state);\n\t    this.showConfig(state);\n\t    this.showTable(state);\n\t    this.showTooltip(state);\n\t    state.Html.setFootnote(state);\n\t    state.Html.setProgress(state, false);\n\t}\n\tthis.showMode(state);\n    };\n    this.showPath=function(state) {\n\tif (state.React.Path !== undefined) {\n\t    state.React.Path.showPath(state); // forceUpdate()\n\t} else {\n\t    console.log(\"No react-path available.\");\n\t}\n\tif (state.React.Location !== undefined) {\n\t    state.React.Location.showLocation(state); // forceUpdate()\n\t} else {\n\t    console.log(\"No react-location available.\");\n\t}\n\tif (state.React.LevelBar !== undefined) {\n\t    state.React.LevelBar.showLevelBar(state); // forceUpdate()\n\t} else {\n\t    console.log(\"No react-disclaimer available.\");\n\t}\n    };\n    this.showConfig=function(state) {\n\tif (state.React.Config !== undefined) {\n\t    state.React.Config.show(state); // forceUpdate()\n\t} else {\n\t    console.log(\"No react-config available.\");\n\t}\n    };\n    this.showMatrix=function(state,matrix) {\n\tif (state.React.Dataset !== undefined) {\n\t    state.React.Dataset.showMatrix(state,matrix);\n\t}\n    };\n    this.showTable=function(state,matrix) {\n\tconsole.log(\"Showing table...\");\n\tif (matrix !== undefined) {\n\t    //console.log(\"Defining matrix...\");\n\t    state.React.matrix=matrix;\n\t};\n\t//console.log(\"ShowTable:\",state.Layout.state.layoutMode,state.Layout.modes.layout.Map);\n\tif (state.Layout.state.layoutMode === state.Layout.modes.layout.Map) {\n\t    if (state.React.Map !== undefined) {\n\t\tstate.React.Map.showMap(state);\n\t    }\n\t} else {\n\t    if (state.React.Table !== undefined) {\n\t\tstate.React.Table.showTable(state);\n\t    }\n\t}\n\tconsole.log(\"Showing table done...\");\n    };\n    this.showTooltip=function(state) {\n\tif (state.React.Tooltip !== undefined) {\n\t    state.React.Tooltip.rebuild();\n\t}\n    };\n    this.useCanvas=function(state,matrix) {    // check if matrix elements have max 1 data\n\t// loop over matrix\n\tfor (var ii in matrix) {\n\t    for (var jj in matrix[ii]) {\n\t\tif (matrix[ii][jj].cnt > 1) {\n\t\t    return false;\n\t\t}\n\t    }\n\t}\n\treturn true;\n    };\n    this.scale=function(xval,xmin,xmax,ymin,ymax) {\n\tif (ymin>ymax) {\n\t    return ymin + (xval-xmin)*(ymax-ymin)/(xmax-xmin);\n\t} else {\n\t    return (xval-xmin)*(ymax-ymin)/(xmax-xmin);\n\t}\n    }\n};\nexport default Show;\n"]},"metadata":{},"sourceType":"module"}