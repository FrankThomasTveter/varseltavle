{"ast":null,"code":"//console.log(\"Loading NavigateLib.js\");\nfunction Navigate() {\n  this.history = {\n    pos: 0,\n    // position of next snapshot\n    track: []\n  };\n  this.home = undefined;\n  this.order = {}; // key order\n\n  this.trash = {}; // key trash\n\n  this.reset = function (state) {\n    // store state\n    state.Navigate.history = {\n      pos: 0,\n      track: []\n    };\n    this.store(state);\n  };\n\n  this.store = function (state) {\n    // store state\n    if (state.Navigate.history.track.length > state.Navigate.history.pos + 1) {\n      state.Navigate.history.track = state.Navigate.history.track.splice(0, state.Navigate.history.pos + 1);\n    } else if (state.Navigate.history.track.length > 10) {\n      state.Navigate.history.track = state.Navigate.history.track.splice(0, 10);\n    }\n\n    ;\n    var snapshot = state.Path.getSnapshot(state);\n    state.Navigate.history.track.push(snapshot);\n    state.Navigate.history.pos = state.Navigate.history.track.length - 1; //console.log(\">>>>>> Stored state...\",JSON.stringify(state.Navigate.history),\n    //\t    this.canUndo(state),this.canRedo(state),\n    //\t    state.Navigate.history.pos,state.Navigate.history.track.length);\n\n    this.refreshHistory(state);\n  };\n\n  this.refreshHistory = function (state) {\n    if (state.React.Config !== undefined) {\n      state.React.Config.show();\n    }\n\n    ;\n  };\n\n  this.canUndo = function (state) {\n    return state.Navigate.history.pos > 0;\n  };\n\n  this.canRedo = function (state) {\n    return state.Navigate.history.pos < state.Navigate.history.track.length - 1;\n  };\n\n  this.undo = function (state) {\n    //console.log(\">>>>>> Undo:\",this.canUndo(state));\n    if (this.canUndo(state)) {\n      state.Navigate.history.pos = state.Navigate.history.pos - 1;\n      var snapshot = state.Navigate.history.track[state.Navigate.history.pos]; //console.log(\"Setting snapshot:\",JSON.stringify(snapshot));\n\n      state.Path.setSnapshot(state, snapshot);\n      this.refreshHistory(state);\n      state.Show.show(state);\n    }\n\n    ;\n  };\n\n  this.redo = function (state) {\n    //console.log(\">>>>>> Redo:\",this.canRedo(state),state.Navigate.history.pos,JSON.stringify(state.Navigate.history.track));\n    if (this.canRedo(state)) {\n      state.Navigate.history.pos = state.Navigate.history.pos + 1;\n      var snapshot = state.Navigate.history.track[state.Navigate.history.pos]; //console.log(\"Setting snapshot:\",JSON.stringify(snapshot));\n\n      state.Path.setSnapshot(state, snapshot);\n      this.refreshHistory(state);\n      state.Show.show(state);\n    }\n  };\n\n  this.setHome = function (state) {\n    var snapshot = state.Path.getSnapshot(state);\n    state.Navigate.home = snapshot;\n  };\n\n  this.goHome = function (state) {\n    //console.log(\">>>>>> Undo:\",this.canUndo(state));\n    var snapshot = state.Navigate.home; //console.log(\"Setting snapshot:\",JSON.stringify(snapshot));\n\n    state.Path.setSnapshot(state, snapshot);\n    this.refreshHistory(state);\n    state.Show.show(state);\n  };\n\n  this.onClickTablePath = function (state, skey, tkey) {\n    var reload = false;\n    var sid = state.Path.keys.other.indexOf(skey);\n    var tid = state.Path.keys.other.indexOf(tkey);\n    console.log(\"Table path: Sid:\", sid, \" tid:\", tid, skey, tkey);\n\n    if (sid !== -1 && tid !== -1) {\n      if (sid > tid) {\n        var src = state.Path.keys.other.splice(sid, 1); // remove from path\n\n        var trg = state.Path.keys.other.splice(tid, 1); // remove from path\n\n        state.Utils.spliceArray(state.Path.keys.other, tid, 0, src); // first position (table)\n\n        state.Utils.spliceArray(state.Path.keys.other, sid, 0, trg); // first position (table)\n\n        state.Path.exportAllKeys(state);\n        reload = true;\n      }\n    }\n\n    state.Html.setFootnote(state, \"Extracting data.\", \"secondary\");\n    state.Navigate.store(state);\n    state.Show.show(state, reload);\n  };\n\n  this.onClickPath = function (state, ttyp, tkey) {\n    var reload = false; // matrix changed?\n\n    var tid, tin, sin, src, sec; //console.log(\"Clicked:\",ttyp,tkey,JSON.stringify(state.Path.keys),JSON.stringify(state.Path.other));\n\n    if (ttyp === \"path\") {\n      // path -> table\n      tid = state.Path.keys.path.indexOf(tkey);\n\n      if (tid !== -1) {\n        src = state.Path.keys.path.splice(tid, 1); // remove from path\n\n        state.Utils.spliceArray(state.Path.keys.other, 0, 0, src); // first position (table)\n\n        state.Path.cleanSelect(state);\n        reload = true;\n      }\n    } else if (ttyp === \"table\") {\n      // other -> table\n      tid = state.Path.keys.other.indexOf(tkey); //console.log(\"Tin:\",tin,\" tid:\",tid);\n\n      if (tid !== -1) {\n        src = state.Path.keys.other.splice(tid, 1); // remove from path\n\n        state.Utils.spliceArray(state.Path.keys.other, 0, 0, src); // first position (table)\n\n        state.Path.exportAllKeys(state);\n        reload = true;\n      }\n    } else if (ttyp === \"rest\") {\n      // rest -> table\n      tid = state.Path.keys.other.indexOf(tkey);\n\n      if (tid !== -1) {\n        src = state.Path.keys.other.splice(tid, 1); // remove from path\n\n        state.Utils.spliceArray(state.Path.keys.other, 0, 0, src); // first position (table)\n\n        reload = true;\n      }\n\n      ;\n    } else if (ttyp === \"trash\") {\n      //console.log(\"Trashing:\",JSON.stringify(state.Path.trash),tkey);\n      tid = state.Path.trash.indexOf(tkey);\n      tin = state.Path.keys.other.indexOf(tkey);\n      sin = state.Path.keys.path.indexOf(tkey);\n\n      if (tid !== -1) {\n        // trash => other\n        src = state.Path.trash.splice(tid, 1);\n        state.Path.keys.other = state.Path.keys.other.concat(src); // last position\n      } else if (sin !== -1 && tin == -1) {\n        // select => other\n        state.Path.keys.other = state.Path.keys.other.concat(tkey); // last position\n      } else if (sin !== -1 && tin !== -1) {\n        // other => select\n        src = state.Path.keys.other.splice(tin, 1);\n      } else if (sin === -1 && tin !== -1) {\n        // other => trash\n        src = state.Path.keys.other.splice(tin, 1);\n        state.Path.trash = state.Path.trash.concat(src); // last position\n      }\n\n      ;\n      state.Path.exportAllKeys(state); //console.log(\"Trashed:\",JSON.stringify(state.Path.trash),JSON.stringify(state.Path.keys.other));\n    }\n\n    state.Html.setFootnote(state, \"Extracting data.\", \"secondary\");\n    state.Navigate.store(state);\n    state.Show.show(state, reload);\n  };\n\n  this.selectItem = function (state, colkey, rowkey, colval, rowval, colwhere, rowwhere, colcnt, rowcnt) {\n    //console.log(\"Selectitem:\",colkey,rowkey,colval,rowval,colwhere,rowwhere,colcnt,rowcnt);\n    //var colkey=state.Path.getColKey(state);\n    //var rowkey=state.Path.getRowKey(state);\n    var order = state.Utils.cp(state.Path.keys.other); //console.log(\"SelectItem:\",colkey,\"=\",colval,\"  \",rowkey,\"=\",rowval);\n\n    if (state.Show.getLayoutMode(state) === state.Show.code.layout.Map) {\n      if (this.selectMapKey(state, colkey, colval, colwhere, colcnt)) {\n        this.order[colkey] = state.Utils.cp(order); //this.flip[colkey]=this.getFlip(state);\n\n        if (this.selectMapKey(state, rowkey, rowval, rowwhere, rowcnt)) {\n          this.order[rowkey] = state.Utils.cp(order); //this.last.flip[rowkey]=this.getFlip(state);\n        }\n\n        this.trash[colkey] = state.Path.checkTableKeys(state); //console.log(\"state.Path.checkTableKeys Done.\",colkey,JSON.stringify(this.trash[colkey]));\n      }\n\n      ; //console.log(\"Path:\",JSON.stringify(state.Path))\n\n      state.Html.setFootnote(state, \"Extracting data.\", \"secondary\");\n      state.Navigate.store(state);\n      state.Show.show(state);\n    } else if (this.selectTableKey(state, colkey, colval, colwhere, colcnt)) {\n      this.order[colkey] = order; //this.flip[colkey]=this.getFlip(state);\n\n      if (this.selectTableKey(state, rowkey, rowval, rowwhere, rowcnt)) {\n        this.order[rowkey] = state.Utils.cp(order); //this.last.flip[rowkey]=this.getFlip(state);\n      }\n\n      this.trash[colkey] = state.Path.checkTableKeys(state); //console.log(\"state.Path.checkTableKeys Done.\",colkey,JSON.stringify(this.trash[colkey]));\n\n      state.Html.setFootnote(state, \"Extracting data.\", \"secondary\");\n      state.Navigate.store(state);\n      state.Show.show(state);\n    } else if (this.selectTableKey(state, rowkey, rowval, rowwhere, rowcnt)) {\n      this.order[rowkey] = order; //this.last.flip[rowkey]=this.getFlip(state);\n\n      this.trash[rowkey] = state.Path.checkTableKeys(state); //console.log(\"state.Path.checkTableKeys Done.\",rowkey,JSON.stringify(this.trash[rowkey]));\n\n      state.Html.setFootnote(state, \"Extracting data.\", \"secondary\");\n      state.Navigate.store(state);\n      state.Show.show(state);\n    } else {\n      console.log(\"Unable to select:\", rowkey, colkey);\n    } //console.log(\"Selectitem Done:\",rowwhere,colwhere);\n\n  };\n\n  this.selectMapKey = function (state, key, val, where, cnt) {\n    // keep abscissa\n    //console.log(\"Table.Selecting:\",key,\"=\",val,\", where=\",where);\n    state.Path.select.val[key] = [val];\n    state.Path.where[key] = where;\n\n    if (state.Utils.missing(state.Path.keys.path, key)) {\n      //console.log(\"Adding to path:\",key);\n      state.Path.keys.path = state.Path.keys.path.concat(key); // last path position\n    }\n\n    ;\n    return true;\n  };\n\n  this.selectTableKey = function (state, key, val, where, cnt) {\n    // keep abscissa\n    //console.log(\"this.Selecting:\",key,\"=\",val,\", where=\",where);\n    var sid = state.Path.keys.other.indexOf(key);\n\n    if (sid !== -1) {\n      state.Path.select.val[key] = [val];\n      state.Path.where[key] = where;\n      var src = state.Path.keys.other.splice(sid, 1); // remove from path\n\n      if (state.Utils.missing(state.Path.keys.path, src)) {\n        //console.log(\"Adding to path:\",JSON.stringify(src));\n        state.Path.keys.path = state.Path.keys.path.concat(src); // last path position\n      }\n\n      ;\n\n      if (cnt > 1 && state.Utils.missing(state.Path.trash, src)) {\n        //console.log(\"Adding \",JSON.stringify(src),\" to trash.\");\n        state.Path.trash = state.Path.trash.concat(src);\n      }\n\n      ; //console.log(\"Selectkey:\",JSON.stringify(setup),JSON.stringify(src));\n\n      return true;\n    } else {\n      console.log(\"Missing \", key, \" in path:\", JSON.stringify(state.Path.keys));\n      return false;\n    }\n  };\n\n  this.selectKey = function (state, key, val, where, cnt) {\n    var order = state.Utils.cp(state.Path.keys.other); //console.log(\"SelecRow: rowkey=\",key,\" val=\",val);\n    //console.log(\"SelectKey:\",key,val,where,cnt);\n\n    if (state.Show.getLayoutMode(state) === state.Show.code.layout.Map) {\n      if (this.selectMapKey(state, key, val, where, cnt)) {\n        this.order[key] = state.Utils.cp(order);\n      }\n\n      state.Html.setFootnote(state, \"Extracting data.\", \"secondary\");\n      state.Navigate.store(state);\n      state.Show.show(state);\n    } else if (this.selectTableKey(state, key, val, where, cnt)) {\n      this.order[key] = order;\n      this.trash[key] = state.Path.checkTableKeys(state); //console.log(\"state.Path.checkTableKeys Done.\",rowkey,JSON.stringify(this.trash[key]));\n\n      state.Html.setFootnote(state, \"Extracting data.\", \"secondary\");\n      state.Navigate.store(state);\n      state.Show.show(state);\n    } else {\n      console.log(\"Unable to select:\", key);\n    } //console.log(\"Finally:\",JSON.stringify(state.Path.keys.other));\n\n  };\n}\n\n;\nexport default Navigate;","map":{"version":3,"sources":["/home/franktt/react/varseltavle/src/lib/NavigateLib.js"],"names":["Navigate","history","pos","track","home","undefined","order","trash","reset","state","store","length","splice","snapshot","Path","getSnapshot","push","refreshHistory","React","Config","show","canUndo","canRedo","undo","setSnapshot","Show","redo","setHome","goHome","onClickTablePath","skey","tkey","reload","sid","keys","other","indexOf","tid","console","log","src","trg","Utils","spliceArray","exportAllKeys","Html","setFootnote","onClickPath","ttyp","tin","sin","sec","path","cleanSelect","concat","selectItem","colkey","rowkey","colval","rowval","colwhere","rowwhere","colcnt","rowcnt","cp","getLayoutMode","code","layout","Map","selectMapKey","checkTableKeys","selectTableKey","key","val","where","cnt","select","missing","JSON","stringify","selectKey"],"mappings":"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","sourcesContent":["//console.log(\"Loading NavigateLib.js\");\n    \nfunction Navigate() {\n    this.history={pos:0, // position of next snapshot\n\t\t  track:[]\n\t\t };\n    this.home=undefined;\n    this.order={};          // key order\n    this.trash={};          // key trash\n    this.reset=function(state) { // store state\n\tstate.Navigate.history={pos:0,track:[]};\n\tthis.store(state);\n    };\n    this.store=function(state) { // store state\n\tif (state.Navigate.history.track.length>state.Navigate.history.pos+1) {\n\t    state.Navigate.history.track=state.Navigate.history.track.splice(0,state.Navigate.history.pos+1)\n\t} else if (state.Navigate.history.track.length > 10) {\n\t   state.Navigate.history.track=state.Navigate.history.track.splice(0,10);\n\t};\n\tvar snapshot=state.Path.getSnapshot(state)\n\tstate.Navigate.history.track.push(snapshot);\n\tstate.Navigate.history.pos=state.Navigate.history.track.length-1;\n\t//console.log(\">>>>>> Stored state...\",JSON.stringify(state.Navigate.history),\n\t//\t    this.canUndo(state),this.canRedo(state),\n\t//\t    state.Navigate.history.pos,state.Navigate.history.track.length);\n\tthis.refreshHistory(state);\n    };\n    this.refreshHistory=function(state) {\n\tif (state.React.Config !== undefined) {\n\t    state.React.Config.show();\n\t};\n    };\n    this.canUndo=function(state) {\n\treturn (state.Navigate.history.pos > 0);\n    };\n    this.canRedo=function(state) {\n\treturn (state.Navigate.history.pos < state.Navigate.history.track.length-1);\n    };\n    this.undo=function(state) {\n\t//console.log(\">>>>>> Undo:\",this.canUndo(state));\n\tif (this.canUndo(state)) {\n\t    state.Navigate.history.pos=state.Navigate.history.pos-1;\n\t    var snapshot=state.Navigate.history.track[state.Navigate.history.pos]\n\t    //console.log(\"Setting snapshot:\",JSON.stringify(snapshot));\n\t    state.Path.setSnapshot(state,snapshot);\n\t    this.refreshHistory(state);\n\t    state.Show.show(state);\n\t};\n    };\n    this.redo=function(state) {\n\t//console.log(\">>>>>> Redo:\",this.canRedo(state),state.Navigate.history.pos,JSON.stringify(state.Navigate.history.track));\n\tif (this.canRedo(state)) {\n\t    state.Navigate.history.pos=state.Navigate.history.pos+1;\t\n\t    var snapshot=state.Navigate.history.track[state.Navigate.history.pos]\n\t    //console.log(\"Setting snapshot:\",JSON.stringify(snapshot));\n\t    state.Path.setSnapshot(state,snapshot);\n\t    this.refreshHistory(state);\n\t    state.Show.show(state);\n\t}\n    };\n    this.setHome=function(state){\n\tvar snapshot=state.Path.getSnapshot(state)\n\tstate.Navigate.home=snapshot;\n    };\n    this.goHome=function(state) {\n\t//console.log(\">>>>>> Undo:\",this.canUndo(state));\n\tvar snapshot=state.Navigate.home;\n\t//console.log(\"Setting snapshot:\",JSON.stringify(snapshot));\n\tstate.Path.setSnapshot(state,snapshot);\n\tthis.refreshHistory(state);\n\tstate.Show.show(state);\n    };\n    this.onClickTablePath=function(state,skey,tkey) {\n\tvar reload=false;\n\tvar sid=state.Path.keys.other.indexOf(skey);\n\tvar tid=state.Path.keys.other.indexOf(tkey);\n\tconsole.log(\"Table path: Sid:\",sid,\" tid:\",tid,skey,tkey);\n\tif (sid !== -1 && tid !== -1) {\n\t    if (sid > tid) {\n\t\tvar src=state.Path.keys.other.splice(sid, 1);                 // remove from path\n\t\tvar trg=state.Path.keys.other.splice(tid, 1);                 // remove from path\n\t\tstate.Utils.spliceArray(state.Path.keys.other,tid,0,src); // first position (table)\n\t\tstate.Utils.spliceArray(state.Path.keys.other,sid,0,trg); // first position (table)\n\t\tstate.Path.exportAllKeys(state);\n\t\treload=true;\n\t    }\n\t}\n\tstate.Html.setFootnote(state,\"Extracting data.\",\"secondary\");\n\tstate.Navigate.store(state);\n\tstate.Show.show(state,reload);\n    };\n    this.onClickPath=function(state,ttyp,tkey) {\n\tvar reload=false; // matrix changed?\n\tvar tid,tin,sin,src,sec;\n\t//console.log(\"Clicked:\",ttyp,tkey,JSON.stringify(state.Path.keys),JSON.stringify(state.Path.other));\n\tif (ttyp  === \"path\") { // path -> table\n\t    tid=state.Path.keys.path.indexOf(tkey);\n\t    if (tid !== -1) {\n\t\tsrc=state.Path.keys.path.splice(tid, 1);                 // remove from path\n\t\tstate.Utils.spliceArray(state.Path.keys.other,0,0,src); // first position (table)\n\t\tstate.Path.cleanSelect(state);\n\t\treload=true;\n\t    }\n\t} else if (ttyp  === \"table\") { // other -> table\n\t    tid=state.Path.keys.other.indexOf(tkey);\n\t    //console.log(\"Tin:\",tin,\" tid:\",tid);\n\t    if (tid !== -1) {\n\t\tsrc=state.Path.keys.other.splice(tid, 1);                 // remove from path\n\t\tstate.Utils.spliceArray(state.Path.keys.other,0,0,src); // first position (table)\n\t\tstate.Path.exportAllKeys(state);\n\t\treload=true;\n\t    }\n\t} else if (ttyp === \"rest\") { // rest -> table\n\t    tid=state.Path.keys.other.indexOf(tkey);\n\t    if (tid !== -1) {\n\t\tsrc=state.Path.keys.other.splice(tid, 1);                 // remove from path\n\t\tstate.Utils.spliceArray(state.Path.keys.other,0,0,src); // first position (table)\n\t\treload=true;\n\t    };\n\t} else if (ttyp === \"trash\") {\n\t    //console.log(\"Trashing:\",JSON.stringify(state.Path.trash),tkey);\n\t    tid=state.Path.trash.indexOf(tkey);\n\t    tin=state.Path.keys.other.indexOf(tkey);\n\t    sin=state.Path.keys.path.indexOf(tkey);\n\t    if (tid !== -1) {                                             // trash => other\n\t\tsrc=state.Path.trash.splice(tid, 1);\n\t\tstate.Path.keys.other=state.Path.keys.other.concat(src);  // last position\n\t    } else if (sin !== -1 && tin == -1) {                         // select => other\n\t\tstate.Path.keys.other=state.Path.keys.other.concat(tkey); // last position\n\t    } else if (sin !== -1 && tin !== -1) {                        // other => select\n\t\tsrc=state.Path.keys.other.splice(tin, 1);\n\t    } else if (sin === -1 && tin !== -1) {                        // other => trash\n\t\tsrc=state.Path.keys.other.splice(tin, 1);\n\t\tstate.Path.trash=state.Path.trash.concat(src);            // last position\n\t    };\n\t    state.Path.exportAllKeys(state);\n\t    //console.log(\"Trashed:\",JSON.stringify(state.Path.trash),JSON.stringify(state.Path.keys.other));\n\t}\n\tstate.Html.setFootnote(state,\"Extracting data.\",\"secondary\");\n\tstate.Navigate.store(state);\n\tstate.Show.show(state,reload);\n    };\n    this.selectItem=function(state,colkey,rowkey,colval,rowval,colwhere,rowwhere,colcnt,rowcnt) {\n\t//console.log(\"Selectitem:\",colkey,rowkey,colval,rowval,colwhere,rowwhere,colcnt,rowcnt);\n\t//var colkey=state.Path.getColKey(state);\n\t//var rowkey=state.Path.getRowKey(state);\n\tvar order=state.Utils.cp(state.Path.keys.other);\n\t//console.log(\"SelectItem:\",colkey,\"=\",colval,\"  \",rowkey,\"=\",rowval);\n\tif (state.Show.getLayoutMode(state)  === state.Show.code.layout.Map) {\n\t    if (this.selectMapKey(state,colkey,colval,colwhere,colcnt)) {\n\t\tthis.order[colkey]=state.Utils.cp(order);\n\t\t//this.flip[colkey]=this.getFlip(state);\n\t\tif (this.selectMapKey(state,rowkey,rowval,rowwhere,rowcnt)) {\n\t\t    this.order[rowkey]=state.Utils.cp(order);\n\t\t    //this.last.flip[rowkey]=this.getFlip(state);\n\t\t}\n\t\tthis.trash[colkey]=state.Path.checkTableKeys(state);\n\t\t//console.log(\"state.Path.checkTableKeys Done.\",colkey,JSON.stringify(this.trash[colkey]));\n\t    };\n\t    //console.log(\"Path:\",JSON.stringify(state.Path))\n\t    state.Html.setFootnote(state,\"Extracting data.\",\"secondary\");\n\t    state.Navigate.store(state);\n\t    state.Show.show(state);\t\n\t} else if (this.selectTableKey(state,colkey,colval,colwhere,colcnt)) {\n\t    this.order[colkey]=order;\n\t    //this.flip[colkey]=this.getFlip(state);\n\t    if (this.selectTableKey(state,rowkey,rowval,rowwhere,rowcnt)) {\n\t\tthis.order[rowkey]=state.Utils.cp(order);\n\t\t//this.last.flip[rowkey]=this.getFlip(state);\n\t    }\n\t    this.trash[colkey]=state.Path.checkTableKeys(state);\n\t    //console.log(\"state.Path.checkTableKeys Done.\",colkey,JSON.stringify(this.trash[colkey]));\n\t    state.Html.setFootnote(state,\"Extracting data.\",\"secondary\");\n\t    state.Navigate.store(state);\n\t    state.Show.show(state);\n\t} else if (this.selectTableKey(state,rowkey,rowval,rowwhere,rowcnt)) {\n\t    this.order[rowkey]=order;\n\t    //this.last.flip[rowkey]=this.getFlip(state);\n\t    this.trash[rowkey]=state.Path.checkTableKeys(state);\n\t    //console.log(\"state.Path.checkTableKeys Done.\",rowkey,JSON.stringify(this.trash[rowkey]));\n\t    state.Html.setFootnote(state,\"Extracting data.\",\"secondary\");\n\t    state.Navigate.store(state);\n\t    state.Show.show(state);\n\t} else {\n\t    console.log(\"Unable to select:\",rowkey,colkey);\n\t}\n\t//console.log(\"Selectitem Done:\",rowwhere,colwhere);\n    };\n    this.selectMapKey=function(state,key,val,where,cnt) { // keep abscissa\n\t//console.log(\"Table.Selecting:\",key,\"=\",val,\", where=\",where);\n\tstate.Path.select.val[key]=[val];\n\tstate.Path.where[key]=where;\n\tif (state.Utils.missing(state.Path.keys.path,key)) {\n\t    //console.log(\"Adding to path:\",key);\n\t    state.Path.keys.path=state.Path.keys.path.concat(key); // last path position\n\t};\n\treturn true;\n    };\n    this.selectTableKey=function(state,key,val,where,cnt) { // keep abscissa\n\t//console.log(\"this.Selecting:\",key,\"=\",val,\", where=\",where);\n\tvar sid = state.Path.keys.other.indexOf(key);\n\tif (sid !== -1) {\n\t    state.Path.select.val[key]=[val];\n\t    state.Path.where[key]=where;\n\t    var src=state.Path.keys.other.splice(sid, 1); // remove from path\n\t    if ( state.Utils.missing(state.Path.keys.path,src)) {\n\t\t//console.log(\"Adding to path:\",JSON.stringify(src));\n\t\tstate.Path.keys.path=state.Path.keys.path.concat(src); // last path position\n\t    };\n\t    if (cnt>1 && state.Utils.missing(state.Path.trash,src)) {\n\t\t//console.log(\"Adding \",JSON.stringify(src),\" to trash.\");\n\t\tstate.Path.trash=state.Path.trash.concat(src)\n\t    };\n\t    //console.log(\"Selectkey:\",JSON.stringify(setup),JSON.stringify(src));\n\t    return true;\n\t} else {\n\t    console.log(\"Missing \",key,\" in path:\",JSON.stringify(state.Path.keys));\n\t    return false;\n\t}\n    };\n    this.selectKey=function(state,key,val,where,cnt) {\n\tvar order=state.Utils.cp(state.Path.keys.other);\n\t//console.log(\"SelecRow: rowkey=\",key,\" val=\",val);\n\t//console.log(\"SelectKey:\",key,val,where,cnt);\n\tif (state.Show.getLayoutMode(state)  === state.Show.code.layout.Map) {\n\t    if (this.selectMapKey(state,key,val,where,cnt)) {\n\t\tthis.order[key]=state.Utils.cp(order);\n\t    }\n\t    state.Html.setFootnote(state,\"Extracting data.\",\"secondary\");\n\t    state.Navigate.store(state);\n\t    state.Show.show(state);\n\t} else if (this.selectTableKey(state,key,val,where,cnt)) {\n\t    this.order[key]=order;\n\t    this.trash[key]=state.Path.checkTableKeys(state);\n\t    //console.log(\"state.Path.checkTableKeys Done.\",rowkey,JSON.stringify(this.trash[key]));\n\t    state.Html.setFootnote(state,\"Extracting data.\",\"secondary\");\n\t    state.Navigate.store(state);\n\t    state.Show.show(state);\n\t} else {\n\t    console.log(\"Unable to select:\",key);\n\t}\n\t//console.log(\"Finally:\",JSON.stringify(state.Path.keys.other));\n    };\n};\nexport default Navigate;\n"]},"metadata":{},"sourceType":"module"}