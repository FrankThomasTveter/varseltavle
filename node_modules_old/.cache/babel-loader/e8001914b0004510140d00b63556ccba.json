{"ast":null,"code":"import _slicedToArray from \"/home/franktt/react/varseltavle_new/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nimport * as THREE from 'three';\n\nvar TWEEN = require('es6-tween'); //import * as TWEEN from 'es6-tween';\n\n\nfunction random(scaleFactor) {\n  return Math.random() > 0.5 ? scaleFactor * Math.random() : -scaleFactor * Math.random();\n} //const MARKER_COLOR = '#ff0000';\n//const MARKER_LIGHT = '#ffcccc';\n\n\nvar MARKER_COMPANION_COLOR = '#ff7777';\nexport default function markerRenderer(marker) {\n  var size = Math.max(marker.value, 1); //  const geometry = new THREE.SphereGeometry(size, 10, 10);\n\n  var geometry = new THREE.BoxGeometry(marker.size.width, marker.size.depth, marker.size.height); //console.log(\"Marker:\",JSON.stringify(marker.size));\n\n  var material = new THREE.MeshBasicMaterial({\n    color: new THREE.Color(marker.bgcolor)\n  }); //  const main = new THREE.Mesh(new THREE.BoxGeometry(0.1,0.1,0.1), material);\n\n  var mesh = new THREE.Mesh(geometry, material);\n  mesh.children = []; // add light\n  //  const light = new THREE.PointLight(MARKER_LIGHT, 1, 0, 0);\n  //  mesh.add(light);\n  // add companion markers based on size\n\n  var companions = [];\n\n  for (var i = 0; i < 0; i++) {\n    var companionGeometry = new THREE.SphereGeometry(Math.min(size * Math.random() / 2, 1), 10, 10);\n    var companionMaterial = new THREE.MeshBasicMaterial({\n      color: new THREE.Color(MARKER_COMPANION_COLOR)\n    });\n    var companion = new THREE.Mesh(companionGeometry, companionMaterial);\n    companion.lookAt(new THREE.Vector3(0, 0, 0));\n    companions.push(companion);\n    mesh.add(companion);\n  }\n\n  companions.forEach(function (companion, i) {\n    function animate() {\n      var from = {\n        opacity: 0.1,\n        position: companion.position.clone().toArray(),\n        scale: Math.max(0.5, Math.random())\n      };\n      var to = {\n        opacity: 0.5,\n        position: [random(size * 3), random(size * 3), random(size)],\n        scale: 0.01\n      };\n      var tween = new TWEEN.Tween(from).to(to, 4000).easing(TWEEN.Easing.Quadratic.InOut).delay(i * 200);\n      tween.on('update', function () {\n        var _from$position = _slicedToArray(from.position, 3),\n            x = _from$position[0],\n            y = _from$position[1],\n            z = _from$position[2];\n\n        var companionMaterial = companion.material; //\n        //const intensityChange = random(0.05);\n        //if (\n        //light.intensity + intensityChange > 0 &&\n        //light.intensity + intensityChange < 1.5\n        //) {\n        //light.intensity += intensityChange;\n        //}\n\n        companionMaterial.opacity = from.opacity;\n        companion.scale.x = from.scale;\n        companion.scale.y = from.scale;\n        companion.scale.z = from.scale;\n        companion.position.set(x, y, z);\n      }).on('complete', animate).start();\n    }\n\n    animate();\n  });\n  return mesh;\n}","map":{"version":3,"sources":["/home/franktt/react/varseltavle_new/src/react/markerRenderer.ts"],"names":["THREE","TWEEN","require","random","scaleFactor","Math","MARKER_COMPANION_COLOR","markerRenderer","marker","size","max","value","geometry","BoxGeometry","width","depth","height","material","MeshBasicMaterial","color","Color","bgcolor","mesh","Mesh","children","companions","i","companionGeometry","SphereGeometry","min","companionMaterial","companion","lookAt","Vector3","push","add","forEach","animate","from","opacity","position","clone","toArray","scale","to","tween","Tween","easing","Easing","Quadratic","InOut","delay","on","x","y","z","set","start"],"mappings":"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","sourcesContent":["import * as THREE from 'three';\nimport { Marker } from 'react-globe';\n\nconst TWEEN = require('es6-tween');\n//import * as TWEEN from 'es6-tween';\n\n\nfunction random(scaleFactor: number): number {\n  return Math.random() > 0.5\n    ? scaleFactor * Math.random()\n    : -scaleFactor * Math.random();\n}\n\n//const MARKER_COLOR = '#ff0000';\n//const MARKER_LIGHT = '#ffcccc';\nconst MARKER_COMPANION_COLOR = '#ff7777';\n\nexport default function markerRenderer(marker: Marker): THREE.Object3D {\n  const size = Math.max(marker.value, 1);\n//  const geometry = new THREE.SphereGeometry(size, 10, 10);\n  const geometry = new THREE.BoxGeometry(marker.size.width,marker.size.depth,marker.size.height);\n  //console.log(\"Marker:\",JSON.stringify(marker.size));\n  const material = new THREE.MeshBasicMaterial({\n    color: new THREE.Color(marker.bgcolor),\n  });\n\n//  const main = new THREE.Mesh(new THREE.BoxGeometry(0.1,0.1,0.1), material);\n  const mesh = new THREE.Mesh(geometry, material);\n  mesh.children = [];\n\n// add light\n//  const light = new THREE.PointLight(MARKER_LIGHT, 1, 0, 0);\n//  mesh.add(light);\n\n  // add companion markers based on size\n  const companions: THREE.Mesh[] = [];\n  for (let i = 0; i < 0; i++) {\n    const companionGeometry = new THREE.SphereGeometry(\n      Math.min((size * Math.random())/2, 1),\n      10,\n      10,\n    );\n    const companionMaterial = new THREE.MeshBasicMaterial({\n      color: new THREE.Color(MARKER_COMPANION_COLOR),\n    });\n    const companion = new THREE.Mesh(companionGeometry, companionMaterial);\n    companion.lookAt(new THREE.Vector3(0, 0, 0));\n    companions.push(companion);\n    mesh.add(companion);\n  }\n\n  companions.forEach(\n    (companion, i: number): void => {\n      function animate(): void {\n        const from = {\n          opacity: 0.1,\n          position: companion.position.clone().toArray(),\n          scale: Math.max(0.5, Math.random()),\n        };\n        const to = {\n          opacity: 0.5,\n          position: [random(size * 3), random(size * 3), random(size)],\n          scale: 0.01,\n        };\n        const tween = new TWEEN.Tween(from)\n          .to(to, 4000)\n          .easing(TWEEN.Easing.Quadratic.InOut)\n          .delay(i * 200);\n        tween\n          .on(\n            'update',\n            (): void => {\n              const [x, y, z] = from.position;\n              const companionMaterial = companion.material as THREE.MeshBasicMaterial; //\n              //const intensityChange = random(0.05);\n              //if (\n                //light.intensity + intensityChange > 0 &&\n                //light.intensity + intensityChange < 1.5\n              //) {\n                //light.intensity += intensityChange;\n              //}\n              companionMaterial.opacity = from.opacity;\n              companion.scale.x = from.scale;\n              companion.scale.y = from.scale;\n              companion.scale.z = from.scale;\n              companion.position.set(x, y, z);\n            },\n          )\n          .on('complete', animate)\n          .start();\n      }\n      animate();\n    },\n  );\n  return mesh;\n}\n"]},"metadata":{},"sourceType":"module"}